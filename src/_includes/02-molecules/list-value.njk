{# ┌─────────────────────────────────────────────────────────┐
   │ MOLECULE › List Value                                   │
   │ Organized list of value-based lockup components         │
   └─────────────────────────────────────────────────────────┘ #}

{#
  Usage — Summon HAT Components Wisely:
    {% from "02-molecules/list-value.njk" import renderListValue %}
    {% from "02-molecules/lockup.njk" import renderLockup as renderLockupComponent %}
    
    {{ renderListValue({ 
        name: "vertical",
        datas: molecules["list-values"],
        lockups: molecules.lockups,
        variant: "default"
    }) }}
    
    With custom styles:
    {{ renderListValue({ 
        name: "columns",
        datas: molecules["list-values"],
        lockups: molecules.lockups,
        class: "my-custom-list-class"
    }) }}
  
  Props:
    - options.name (string): List configuration identifier
    - options.datas (object): List value configuration
    - options.lockups (object): Lockups molecule data
    - options.variant (string): Style variant (default: "default")
    - options.class (string): Additional CSS classes
  
  Features:
    - Style variants for list appearance
    - Container and item-specific styling
    - Integrates with lockup molecule
    - Supports label-value, value-legend, block-content types
    - Falls back to first configuration if name not found
  
  @created 2025-01-15
#}

{% macro renderListValue(options) %}
  {% if options.datas %}
    {% set globalStyle = options.datas.globalStyle | default('') %}
    
    {% set listConfiguration = null %}
    {% if options.name %}
      {% for config in options.datas.listConfigurations %}
        {% if config.name == options.name %}
          {% set listConfiguration = config %}
        {% endif %}
      {% endfor %}
    {% endif %}

    {% if not listConfiguration %}
      {% set listConfiguration = options.datas.listConfigurations[0] %}
    {% endif %}
    
    {% set variantStyle = options.variant | default('default') %}
    {% if options.datas.variants[variantStyle] %}
      {% set variantClass = options.datas.variants[variantStyle] %}
    {% else %}
      {% set variantClass = options.datas.variants.default | default('') %}
    {% endif %}
    
    <div class="{{ globalStyle }} {{ variantClass }} {{ options.class | default('') }}">
      <div class="{{ listConfiguration.containerStyle }}">
        {% for lockup in listConfiguration.lockups %}
          <div class="{{ listConfiguration.itemStyle }}">
            {% if options.lockups %}
              {# Try to find the corresponding lockup #}
              {% set lockupFound = false %}
              {% for availableLockup in options.lockups.lockups %}
                {% if availableLockup.name == lockup.name %}
                  {% if renderLockupComponent %}
                    {{ renderLockupComponent({ 
                      datas: options.lockups,
                      name: lockup.name,
                      type: lockup.type | default(availableLockup.type),
                      class: lockup.class | default('')
                    }) }}
                  {% else %}
                    <div>
                      {% if availableLockup.type == "label-value" %}
                        <div>
                          {{ availableLockup.label.text | default('Label') }}
                        </div>
                        <div>
                          {{ availableLockup.value.text | default('Value') }}
                        </div>
                      {% elif availableLockup.type == "value-legend" %}
                        <div>
                          {{ availableLockup.value.text | default('Value') }}
                        </div>
                        <div>
                          {{ availableLockup.legend.text | default('Legend') }}
                        </div>
                      {% elif availableLockup.type == "block-content" %}
                        <div>Block content</div>
                        <div>
                          {{ availableLockup.content.text | default('Content') }}
                        </div>
                      {% endif %}
                    </div>
                  {% endif %}
                  {% set lockupFound = true %}
                {% endif %}
              {% endfor %}
              
              {% if not lockupFound %}
                <div>Lockup "{{ lockup.name }}" not found</div>
              {% endif %}
            {% else %}
              <div>No lockups data provided</div>
              
              {# Debug placeholder to show what we have instead #}
              <div>
                <pre>Lockup: {{ lockup | dump(2) }}</pre>
              </div>
            {% endif %}
          </div>
        {% endfor %}
      </div>
    </div>
  {% else %}
    <span>List-value data not found</span>
  {% endif %}
{% endmacro %}


{#
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
May your bugs be forever exiled to the shadow realm ✦
Charlotte Carpentier · 2025
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
#}
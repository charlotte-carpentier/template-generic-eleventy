{# ┌─────────────────────────────────────────────────────────┐
   │ MOLECULE › List Group                                   │
   │ Grouped lists with multiple interaction types          │
   └─────────────────────────────────────────────────────────┘ #}

{#
  Props:
    - options.name (string): List group identifier
    - options.datas (array): List group configuration data
    - options.iconDatas (array): Icon atom data
    - options.linkDatas (array): Link atom data (if type is "link")
    - options.iconDatas (array): Icon atom data
    - options.tooltipDatas (array): Tooltip atom data (optional, required if links have tooltips)
    - options.radioDatas (array): Radio button atom data (if type is "radio")
    - options.checkboxDatas (array): Checkbox atom data (if type is "checkbox")
    - options.toggleDatas (array): Toggle atom data (if type is "toggle")

  Usage — Summon HAT Components Wisely:
    {% from "02-molecules/list-group.njk" import renderListGroup %}

    {{ renderListGroup({
        name: "demoGroup1",
        datas: molecules["list-group"].listGroups,
        iconDatas: atoms.icon.icons
    }) }}

    {{ renderListGroup({
        name: "demoGroup3",
        datas: molecules["list-group"].listGroups,
        iconDatas: atoms.icon.icons,
        linkDatas: atoms.link.links
    }) }}

    {{ renderListGroup({
        name: "demoGroup4",
        datas: molecules["list-group"].listGroups,
        iconDatas: atoms.icon.icons,
        radioDatas: atoms["radio-button"].radioButtons
    }) }}

  JavaScript: utils/dismiss.js

  @created 2025-01-15
#}

{% from "01-atoms/icon.njk" import renderIcon %}
{% from "01-atoms/link.njk" import renderLink %}
{% from "01-atoms/radio-button.njk" import renderRadioButton %}
{% from "01-atoms/checkbox.njk" import renderCheckbox %}
{% from "01-atoms/toggle.njk" import renderToggle %}

{% macro renderListGroup(options) %}

  {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
    1. Validate Props
  ━━━━━━━━━━━━━━━━━━━━━━━━━ #}
  {% if not options.datas %}
    <span class="error" role="alert">Error: Missing required prop (datas)</span>
  {% elif not options.name %}
    <span class="error" role="alert">Error: Missing required prop (name)</span>
  {% else %}
    {# Find list group using universal filter #}
    {% set listData = options.datas | findByName(options.name) %}

    {# Render list group or error message #}
    {% if not listData %}
      <span class="error" role="alert">List group not found: {{ options.name }}</span>
    {% else %}

      {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
        2. Compute Final Values
      ━━━━━━━━━━━━━━━━━━━━━━━━━ #}
      {% set listType = listData.type | default('default') %}
      {% set items = listData.items | default([]) %}

      {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
        3. Tailwind Classes
        Index:
        3.1 Wrapper Classes
        3.2 Item Classes
        3.3 Icon Wrapper Classes
        3.4 Text Classes
        3.5 Close Button Classes
      ━━━━━━━━━━━━━━━━━━━━━━━━━ #}

      {# --------------------------
          3.1 Wrapper Classes
          Description: Layout vertical, Background, Borders
        --------------------------#}
      {% set containerClasses = "flex flex-col bg-[var(--color-global-white)] border border-[var(--color-global-contrast-light-03)] rounded-[var(--radius-default)] overflow-hidden" %}

      {# --------------------------
          3.2 Item Classes
          Description: Layout horizontal, Spacing, Borders, States
        --------------------------#}
      {% set itemBaseClasses = "flex items-center gap-[var(--spacing-inline-medium)] px-[var(--spacing-inset-small)] py-[var(--spacing-stack-small)] border-b border-[var(--color-global-contrast-light-03)] last:border-b-0" %}

      {% set itemInteractiveMap = {
        'default': '',
        'closable': 'transition-colors hover:bg-[var(--color-global-contrast-light-04)] cursor-pointer',
        'link': 'transition-colors hover:bg-[var(--color-global-contrast-light-04)] cursor-pointer',
        'radio': 'transition-colors hover:bg-[var(--color-global-contrast-light-04)] cursor-pointer',
        'checkbox': 'transition-colors hover:bg-[var(--color-global-contrast-light-04)] cursor-pointer',
        'toggle': 'transition-colors hover:bg-[var(--color-global-contrast-light-04)] cursor-pointer'
      } %}
      {% set itemInteractiveClasses = itemInteractiveMap[listType] | default('') %}

      {% set itemClasses = itemBaseClasses ~ " " ~ itemInteractiveClasses %}

      {# --------------------------
          3.3 Icon Wrapper Classes
          Description: Layout, Colors
        --------------------------#}
      {% set iconWrapperClasses = "flex-shrink-0 inline-flex items-center text-[var(--color-semantic-information)]" %}

      {# --------------------------
          3.4 Text Classes
          Description: Typography, Layout, Spacing
        --------------------------#}
      {% set textClasses = "font-body text-body text-[var(--color-global-default)] flex-1 pr-[var(--spacing-inline-large)]" %}

      {# --------------------------
          3.5 Close Button Classes
          Description: Layout, Colors, States
        --------------------------#}
      {% set closeButtonClasses = "flex-shrink-0 inline-flex items-center justify-center min-w-[24px] min-h-[24px] w-6 h-6 text-[var(--color-global-default)] bg-transparent border-0 cursor-pointer transition-colors hover:text-[var(--color-global-contrast-light-01)] focus:outline-none focus:ring-2 focus:ring-[var(--color-semantic-information-focus)] focus:ring-offset-2" %}

      {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
        4. Render HTML
      ━━━━━━━━━━━━━━━━━━━━━━━━━ #}
      {% if listType == "radio" %}
        <fieldset
          role="radiogroup"
          class="{{ containerClasses }}"
          data-dismissible
          data-list-group-name="{{ listData.name }}"
          data-list-group-type="{{ listType }}"
        >
          <legend class="sr-only">{{ listData.name }}</legend>
          {% for item in items %}
            <div
              class="{{ itemClasses }}"
              data-list-group-item="true"
            >
              {# Icon (always present) #}
              <div class="{{ iconWrapperClasses }}">
                {{ renderIcon({
                    name: item.iconName,
                    datas: options.iconDatas,
                    decorative: true
                }) }}
              </div>

              {# Text #}
              <span
                class="{{ textClasses }}"
                data-list-group-text="true"
              >
                {{ item.text }}
              </span>

              {# Radio button #}
              {{ renderRadioButton({
                  id: item.radioName,
                  datas: options.radioDatas
              }) }}
            </div>
          {% endfor %}
        </fieldset>

      {% else %}
        <div
          class="{{ containerClasses }}"
          data-dismissible
          data-list-group-name="{{ listData.name }}"
          data-list-group-type="{{ listType }}"
          {% if listType in ['checkbox', 'toggle'] %}
            role="group"
            aria-label="{{ listData.name }}"
          {% endif %}
        >
          {% for item in items %}
            <div
              class="{{ itemClasses }}"
              data-list-group-item="true"
            >
              {# Icon (always present) #}
              <div class="{{ iconWrapperClasses }}">
                {{ renderIcon({
                    name: item.iconName,
                    datas: options.iconDatas,
                    decorative: true
                }) }}
              </div>

              {# Text #}
              <span
                class="{{ textClasses }}"
                data-list-group-text="true"
              >
                {{ item.text }}
              </span>

              {# Type-specific elements #}
              {% if listType == "closable" %}
                {# Close icon #}
                <button
                  type="button"
                  class="{{ closeButtonClasses }}"
                  data-dismiss
                  aria-label="Close"
                >
                  {{ renderIcon({
                      name: item.iconClose,
                      datas: options.iconDatas,
                      decorative: true
                  }) }}
                </button>

              {% elif listType == "link" %}
                {# Link #}
                {{ renderLink({
                    name: item.linkName,
                    datas: options.linkDatas,
                    iconDatas: options.iconDatas,
                    tooltipDatas: options.tooltipDatas
                }) }}

              {% elif listType == "checkbox" %}
                {# Checkbox #}
                {{ renderCheckbox({
                    id: item.checkboxName,
                    datas: options.checkboxDatas
                }) }}

              {% elif listType == "toggle" %}
                {# Toggle #}
                {{ renderToggle({
                    id: item.toggleName,
                    datas: options.toggleDatas
                }) }}
              {% endif %}
            </div>
          {% endfor %}
        </div>
      {% endif %}
    {% endif %}
  {% endif %}
{% endmacro %}

{#
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
May your bugs be forever exiled to the shadow realm ✦
HAT · 2026
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
#}

{# ┌─────────────────────────────────────────────────────────┐
   │ MOLECULE › Breadcrumb                                   │
   │ Navigation breadcrumb trail with link hierarchy         │
   └─────────────────────────────────────────────────────────┘ #}

{#
  Props:
    - options.name (string): Breadcrumb identifier
    - options.datas (array): Breadcrumb configuration data
    - options.linkDatas (array): Link atom data for breadcrumb items

  Usage — Summon HAT Components Wisely:
    {% from "02-molecules/breadcrumb.njk" import renderBreadcrumb %}

    {{ renderBreadcrumb({
        name: "demoBreadcrm1",
        datas: molecules.breadcrumb.breadcrumbs,
        linkDatas: atoms.link.links
    }) }}

  @created 2025-01-15
#}

{% from "01-atoms/link.njk" import renderLink %}

{% macro renderBreadcrumb(options) %}

  {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
    1. Validate Props
  ━━━━━━━━━━━━━━━━━━━━━━━━━ #}
  {% if not options.datas %}
    <span class="error" role="alert">Error: Missing required prop (datas)</span>
  {% elif not options.name %}
    <span class="error" role="alert">Error: Missing required prop (name)</span>
  {% else %}
    {# Find breadcrumb using universal filter #}
    {% set breadcrumbData = options.datas | findByName(options.name) %}

    {# Render breadcrumb or error message #}
    {% if not breadcrumbData %}
      <span class="error" role="alert">Breadcrumb not found: {{ options.name }}</span>
    {% else %}

      {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
        2. Compute Final Values
      ━━━━━━━━━━━━━━━━━━━━━━━━━ #}
      {% set breadcrumbLinks = breadcrumbData.breadcrumbLinks | default([]) %}

      {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
        3. Tailwind Classes
        Index:
        3.1 Wrapper Classes
        3.2 List Classes
        3.3 Item Classes
        3.4 Separator Classes
        3.5 Page Classes
      ━━━━━━━━━━━━━━━━━━━━━━━━━ #}

      {# --------------------------
          3.1 Wrapper Classes
          Description: Layout
        --------------------------#}
      {% set navClasses = "" %}

      {# --------------------------
          3.2 List Classes
          Description: Layout, Spacing
        --------------------------#}
      {% set listClasses = "flex flex-wrap items-center gap-[var(--spacing-inline-small)]" %}

      {# --------------------------
          3.3 Item Classes
          Description: Layout
        --------------------------#}
      {% set listItemClasses = "flex items-center gap-[var(--spacing-inline-small)]" %}

      {# --------------------------
          3.4 Separator Classes
          Description: Typography, Colors
        --------------------------#}
      {% set separatorClasses = "typography-body-regular text-[var(--color-global-default)]" %}

      {# --------------------------
          3.5 Page Classes
          Description: Typography, Colors, States
        --------------------------#}
      {% set currentPageClasses = "typography-body-regular text-[var(--color-global-contrast-light-02)]" %}

      {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
        4. Render HTML
      ━━━━━━━━━━━━━━━━━━━━━━━━━ #}
      <nav
        class="{{ navClasses }}"
        aria-label="Breadcrumb"
        data-breadcrumb-name="{{ breadcrumbData.name }}"
        data-breadcrumb-type="breadcrumb"
      >
        <ol class="{{ listClasses }}">
          {% for item in breadcrumbLinks %}
            <li class="{{ listItemClasses }}">
              {# Separator (skip for first item) #}
              {% if not loop.first %}
                <span
                  class="{{ separatorClasses }}"
                  data-breadcrumb-separator="true"
                  aria-hidden="true"
                >
                  /
                </span>
              {% endif %}

              {# Link item #}
              {% if item.type == "link" %}
                {{ renderLink({
                    name: item.linkName,
                    datas: options.linkDatas
                }) }}

              {# Current page (no link) #}
              {% elif item.type == "current" %}
                <span
                  class="{{ currentPageClasses }}"
                  data-breadcrumb-current="true"
                  aria-current="page"
                >
                  {{ item.text }}
                </span>
              {% endif %}
            </li>
          {% endfor %}
        </ol>
      </nav>
    {% endif %}
  {% endif %}
{% endmacro %}

{#
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
May your bugs be forever exiled to the shadow realm ✦
HAT · 2025
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
#}

{# ┌─────────────────────────────────────────────────────────┐
   │ MOLECULE › Pagination                                   │
   │ Complete pagination with navigation and count           │
   └─────────────────────────────────────────────────────────┘ #}

{#
  Props:
    - options.name (string): Pagination identifier
    - options.datas (array): Pagination configuration data
    - options.selectDatas (array): Select atom data (optional)
    - options.buttonDatas (array): Button atom data (optional)
    - options.iconDatas (array): Icon atom data (optional)
    - options.currentPage (number): Current active page
    - options.totalPages (number): Total number of pages
    - options.itemsPerPage (number): Items per page
    - options.totalItems (number): Total count of items

  Usage — Summon HAT Components Wisely:
    {% from "02-molecules/pagination.njk" import renderPagination %}

    {{ renderPagination({
        name: "demoPagination1",
        datas: molecules.pagination.paginations,
        selectDatas: atoms.select.selects,
        buttonDatas: atoms.button.buttons,
        iconDatas: atoms.icon.icons,
        currentPage: 1,
        totalPages: 10,
        itemsPerPage: 10,
        totalItems: 98
    }) }}

  @created 2025-01-15
#}

{% from "01-atoms/select.njk" import renderSelect %}
{% from "01-atoms/button.njk" import renderButton %}
{% from "01-atoms/icon.njk" import renderIcon %}

{% macro renderPagination(options) %}

  {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
    1. Validate Props
  ━━━━━━━━━━━━━━━━━━━━━━━━━ #}
  {% if not options.datas %}
    <span class="error" role="alert">Error: Missing required prop (datas)</span>
  {% elif not options.name %}
    <span class="error" role="alert">Error: Missing required prop (name)</span>
  {% else %}
    {# Find pagination using universal filter #}
    {% set paginationData = options.datas | findByName(options.name) %}

    {# Render pagination or error message #}
    {% if not paginationData %}
      <span class="error" role="alert">Pagination not found: {{ options.name }}</span>
    {% else %}

      {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
        2. Compute Final Values
      ━━━━━━━━━━━━━━━━━━━━━━━━━ #}
      {% set paginationName = paginationData.name | default(options.name) %}
      {% set itemsPerPageData = paginationData.itemsPerPage | default({}) %}
      {% set selectName = itemsPerPageData.selectName | default('') %}
      {% set navigationData = paginationData.navigationPager | default({}) %}
      {% set pages = paginationData.pages | default([]) %}
      {% set totalCountData = paginationData.totalCount | default({}) %}
      {% set showCounter = totalCountData.show | default(false) %}
      {% set currentPage = options.currentPage | default(1) %}
      {% set totalPages = options.totalPages | default(1) %}
      {% set itemsPerPage = options.itemsPerPage | default(10) %}
      {% set totalItems = options.totalItems | default(0) %}

      {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
        3. Tailwind Classes
        Index:
        3.1 Wrapper Classes
        3.2 Select Wrapper Classes
        3.3 Nav Wrapper Classes
        3.4 Nav List Classes
        3.5 Nav Item Classes
        3.6 Nav Link Classes
        3.7 Counter Classes
      ━━━━━━━━━━━━━━━━━━━━━━━━━ #}

      {# --------------------------
          3.1 Wrapper Classes
          Description: Layout horizontal, Spacing, Alignment
        --------------------------#}
      {% set containerClasses = "flex items-center justify-between gap-[var(--spacing-12)] w-full" %}

      {# --------------------------
          3.2 Select Wrapper Classes
          Description: Layout
        --------------------------#}
      {% set selectWrapperClasses = "hidden md:flex flex-shrink-0" %}

      {# --------------------------
          3.3 Nav Wrapper Classes
          Description: Layout
        --------------------------#}
      {% set navWrapperClasses = "flex-1 flex justify-center" %}

      {# --------------------------
          3.4 Nav List Classes
          Description: Layout horizontal, Spacing
        --------------------------#}
      {% set navListClasses = "flex items-center gap-[var(--spacing-0-5)]" %}

      {# --------------------------
          3.5 Nav Item Classes
          Description: Layout
        --------------------------#}
      {% set navItemClasses = "" %}

      {# --------------------------
          3.6 Nav Link Classes
          Description: Layout, Typography, Colors, Borders, States
        --------------------------#}
      {% set navLinkBaseClasses = "inline-flex items-center justify-center min-w-[2rem] h-8 px-[var(--spacing-2)] typography-body-regular text-[var(--color-brand-primary-40)] bg-transparent border border-transparent rounded-[var(--radius-default)] transition-colors hover:bg-[var(--color-brand-primary-30)] hover:text-[var(--color-global-white)]  focus:outline-none focus:ring-2 focus:ring-[var(--color-semantic-information-focus)]" %}

      {# --------------------------
          3.7 Counter Classes
          Description: Typography, Colors
        --------------------------#}
      {% set counterClasses = "hidden md:flex flex-shrink-0 typography-body-regular text-[var(--color-brand-primary-30)]" %}

      {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
        4. Render HTML
      ━━━━━━━━━━━━━━━━━━━━━━━━━ #}
      <div
        class="{{ containerClasses }}"
        data-pagination-name="{{ paginationName }}"
        data-pagination-type="pagination"
      >
        {# Items per page selector (if selectName provided) #}
        {% if selectName and options.selectDatas %}
          <div
            class="{{ selectWrapperClasses }}"
            data-pagination-selector="true"
          >
            {{ renderSelect({
                name: selectName,
                datas: options.selectDatas
            }) }}
          </div>
        {% endif %}

        {# Navigation #}
        {% if pages and pages | length > 0 %}
          <nav
            class="{{ navWrapperClasses }}"
            role="navigation"
            aria-label="Pagination"
            data-pagination-nav="true"
          >
            <ul class="{{ navListClasses }}">
              {% for page in pages %}
                <li class="{{ navItemClasses }}">
                  {# Icon button (first, prev, next, last) or page number #}
                  {% if page.iconName %}

                    <a href="{{ page.url | default('#') }}"
                      class="{{ navLinkBaseClasses }}"
                      data-pagination-link="true"
                      data-pagination-action="{{ page.action }}"
                      aria-label="{{ page.ariaLabel | default('Navigate') }}"
                      rel="nofollow"
                    >
                      {{ renderIcon({
                          name: page.iconName,
                          datas: options.iconDatas
                      }) }}
                    </a>
                  {% else %}

                    <a href="{{ page.url | default('#') }}"
                      class="{{ navLinkBaseClasses }} {% if page.current %}{{ navLinkActiveClasses }}{% endif %}"
                      data-pagination-link="true"
                      {% if page.current %}data-pagination-current="true" aria-current="page"{% endif %}
                      rel="nofollow"
                    >
                      {{ page.label }}
                    </a>
                  {% endif %}
                </li>
              {% endfor %}
            </ul>
          </nav>
        {% endif %}

        {# Items counter (if enabled and data provided) #}
        {% if showCounter and totalItems > 0 and currentPage and itemsPerPage %}
          {% set firstItem = (currentPage - 1) * itemsPerPage + 1 %}
          {% set lastItem = currentPage * itemsPerPage %}
          {% if lastItem > totalItems %}
            {% set lastItem = totalItems %}
          {% endif %}

          <div
            class="{{ counterClasses }}"
            data-pagination-counter="true"
          >
            <span>
              {{ firstItem }}-{{ lastItem }} of {{ totalItems }}
            </span>
          </div>
        {% endif %}
      </div>
    {% endif %}
  {% endif %}
{% endmacro %}

{#
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
May your bugs be forever exiled to the shadow realm ✦
HAT · 2025
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
#}

{# ┌─────────────────────────────────────────────────────────┐
   │ MOLECULE › Progress Bar                                 │
   │ Progress indicator with label and percentage            │
   └─────────────────────────────────────────────────────────┘ #}

{#
  Props:
    - options.name (string): Progress bar identifier
    - options.datas (array): Progress bar configuration data

  Usage — Summon HAT Components Wisely:
    {% from "02-molecules/progress-bar.njk" import renderProgressBar %}

    {{ renderProgressBar({
        name: "demoProgr1",
        datas: molecules["progress-bar"].progressBars
    }) }}

  @created 2025-01-15
#}

{% macro renderProgressBar(options) %}
  {# Validate required props #}
  {% if not options.datas %}
    <span class="error" role="alert">Error: Missing required prop (datas)</span>
  {% elif not options.name %}
    <span class="error" role="alert">Error: Missing required prop (name)</span>
  {% else %}
    {# Find progress bar using universal filter #}
    {% set progressData = options.datas | findByName(options.name) %}

    {# Render or error #}
    {% if not progressData %}
      <span class="error" role="alert">Progress bar not found: {{ options.name }}</span>
    {% else %}
      <div
        data-progress-name="{{ progressData.name }}"
        data-progress-type="progress-bar"
      >
        {# Label and percentage #}
        {% if progressData.showLabels %}
          <div data-progress-labels="true">
            <span data-progress-label="true">{{ progressData.label }}</span>
            {% if progressData.showPercentage %}
              <span data-progress-percentage="true">{{ progressData.value }}%</span>
            {% endif %}
          </div>
        {% endif %}

        {# Progress bar visual #}
        <div
          data-progress-track="true"
          role="progressbar"
          aria-valuenow="{{ progressData.value }}"
          aria-valuemin="{{ progressData.min }}"
          aria-valuemax="{{ progressData.max }}"
          aria-label="Progress: {{ progressData.value }}%"
        >
          <div
            data-progress-fill="true"
            data-progress-value="{{ progressData.value }}"
          ></div>
        </div>
      </div>
    {% endif %}
  {% endif %}
{% endmacro %}

{#
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
May your bugs be forever exiled to the shadow realm ✦
Charlotte Carpentier · 2025
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
#}

{# ┌─────────────────────────────────────────────────────────┐
   │ MOLECULE › Progress Bar                                 │
   │ Progress indicator with label and description           │
   └─────────────────────────────────────────────────────────┘ #}

{#
  Usage — Summon HAT Components Wisely:
    {% from "02-molecules/progress-bar.njk" import renderProgressBar %}
    {{ renderProgressBar({ 
        name: "learning_loop",
        datas: molecules["progress-bar"]["progress-bars"],
        typographyDatas: atoms.typography.texts
    }) }}
  
  Props:
    - option.name (string): Progress bar identifier
    - option.datas (array): Progress bar configuration
    - option.typographyDatas (array): Typography atom data
  
  Features:
    - Visual progress bar with percentage width
    - Label and description using typography atoms
    - Progress value display
  
  Accessibility:
    - role="progressbar" with ARIA attributes
    - aria-valuenow, aria-valuemin, aria-valuemax
    - aria-label for screen reader context
    - role="alert" for error states
  
  @created 2025-01-15
#}

{# Import atoms #}
{% from "01-atoms/heading.njk" import renderHeading %}

{% macro renderProgressBar(option) %}
  {# Check if datas is provided #}
  {% if not option.datas %}
    <span role="alert">Error: No progress-bar configuration provided</span>
  {% else %}
    {# Retrieve progress-bar configuration #}
    {% set progressBarConfig = option.datas %}
    {% set progressBarName = option.name %}
    
    {# Find the specific progress-bar by name #}
    {% set progressBarData = null %}
    {% for progressBar in progressBarConfig %}
      {% if progressBar.name == progressBarName %}
        {% set progressBarData = progressBar %}
      {% endif %}
    {% endfor %}

    {# Fallback if progress-bar not found #}
    {% if not progressBarData %}
      <span role="alert">Progress-bar not found: {{ progressBarName }}</span>
    {% else %}
      {# Render progress-bar molecule #}
      <div class="">
        {# Progress bar visual with accessibility attributes #}
        <div class="">
          <div class="" 
               role="progressbar" 
               aria-valuenow="{{ progressBarData.value }}" 
               aria-valuemin="0" 
               aria-valuemax="100"
               aria-label="Progress: {{ progressBarData.value }}%">
            <div class="" style="width: {{ progressBarData.value }}%;"></div>
          </div>
        </div>
        
        {# Typography atoms for label and description #}
        <div class="">
          {{ renderHeading({ 
              name: progressBarData.labelName,
              datas: option.typographyDatas,
              tag: "span"
          }) }}
          {{ renderHeading({ 
              name: progressBarData.descriptionName,
              datas: option.typographyDatas,
              tag: "span"
          }) }}
        </div>
      </div>
    {% endif %}
  {% endif %}
{% endmacro %}

{#
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
May your bugs be forever exiled to the shadow realm ✦
Charlotte Carpentier · 2025
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
#}
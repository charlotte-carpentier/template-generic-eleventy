{# ┌─────────────────────────────────────────────────────────┐
   │ MOLECULE › Toast                                        │
   │ Temporary notification messages with auto-dismiss       │
   └─────────────────────────────────────────────────────────┘ #}

{#
  Usage — Summon HAT Components Wisely:
    {% from "02-molecules/toast.njk" import renderToast %}
    {{ renderToast({ 
        name: "success_notification", 
        datas: molecules.toasts,
        icons: atoms.icons 
    }) }}
  
  Props:
    - options.name (string): Toast identifier
    - options.datas (object): Toast configuration
    - options.icons (object): Icons atom data
  
  Features:
    - Style variants (success, error, warning, info)
    - Optional icon display
    - Dismissible with close button
    - Auto-dismiss duration support (data attribute)
    - Message content from configuration
  
  Accessibility:
    - aria-live="polite" for screen reader announcements
    - role="status" for notification semantics
    - aria-label on dismiss button
    - aria-hidden for decorative icons
  
  @created 2025-01-15
#}

{% macro renderToast(options) %}
  {% if options.datas %}
    {% set toastData = null %}
    
    {% if options.name %}
      {% for toast in options.datas.toasts %}
        {% if toast.name == options.name %}
          {% set toastData = toast %}
        {% endif %}
      {% endfor %}
    {% endif %}

    {% if not toastData %}
      <span>Toast not found: {{ options.name }}</span>
    {% else %}
      {% set globalStyle = options.datas.globalStyle %}
      {% set variantStyle = options.datas.variants[toastData.style] %}
      {% set iconStyle = options.datas.iconStyles.default %}
      
      {% set iconData = null %}
      {% if toastData.icon and options.icons %}
        {% for icon in options.icons.icons %}
          {% if icon.name == toastData.icon %}
            {% set iconData = icon %}
          {% endif %}
        {% endfor %}
      {% endif %}

      <div 
        class=""
        aria-live="polite" 
        role="status"
        data-toast="{{ options.name }}"
        data-toast-duration="{{ toastData.duration }}"
      >
        <div 
          class="{{ globalStyle }} {{ variantStyle }}"
        >
          <div>
            <div>
              {% if iconData %}
                <span 
                  data-svg-src="{{ iconData.path }}" 
                  class="{{ iconStyle }}" 
                  aria-hidden="true"
                ></span>
              {% endif %}
              <span>{{ toastData.message }}</span>
            </div>
            
            {% if toastData.dismissible %}
              <button 
                data-dismiss
                aria-label="Dismiss notification"
              >
                &times;
              </button>
            {% endif %}
          </div>
        </div>
      </div>
    {% endif %}
  {% else %}
    <span>No toast data provided</span>
  {% endif %}
{% endmacro %}

{#
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
May your bugs be forever exiled to the shadow realm ✦
Charlotte Carpentier · 2025
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
#}
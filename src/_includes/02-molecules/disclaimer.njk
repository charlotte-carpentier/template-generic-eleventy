{# ┌─────────────────────────────────────────────────────────┐
   │ MOLECULE › Disclaimer                                   │
   │ Alert messages with semantic variants and actions       │
   └─────────────────────────────────────────────────────────┘ #}

{#
  Props:
    - options.name (string): Disclaimer identifier
    - options.datas (array): Disclaimer configuration data
    - options.iconDatas (array): Icon atom data

  Usage — Summon HAT Components Wisely:
    {% from "02-molecules/disclaimer.njk" import renderDisclaimer %}

    {{ renderDisclaimer({
        name: "demoDiscla1",
        datas: molecules.disclaimer.disclaimers,
        iconDatas: atoms.icon.icons
    }) }}

  @created 2025-01-15
#}

{% from "01-atoms/icon.njk" import renderIcon %}

{% macro renderDisclaimer(options) %}
  {# Validate required props #}
  {% if not options.datas %}
    <span class="error" role="alert">Error: Missing required prop (datas)</span>
  {% elif not options.name %}
    <span class="error" role="alert">Error: Missing required prop (name)</span>
  {% else %}
    {# Find disclaimer using universal filter #}
    {% set disclaimerData = options.datas | findByName(options.name) %}

    {# Render or error #}
    {% if not disclaimerData %}
      <span class="error" role="alert">Disclaimer not found: {{ options.name }}</span>
    {% else %}
      <div
        data-disclaimer-name="{{ disclaimerData.name }}"
        data-disclaimer-type="disclaimer"
        data-disclaimer-variant="{{ disclaimerData.variant }}"
        role="alert"
        aria-live="polite"
      >
        <div data-disclaimer-content="true">
          {# Icon (if present) #}
          {% if disclaimerData.iconName and options.iconDatas %}
            <div data-disclaimer-icon="true">
              {{ renderIcon({
                  name: disclaimerData.iconName,
                  datas: options.iconDatas
              }) }}
            </div>
          {% endif %}

          {# Message #}
          <span data-disclaimer-message="true">
            {{ disclaimerData.message }}
          </span>

          {# Close button (if present) #}
          {% if disclaimerData.closeIconName and options.iconDatas %}
            <button
              type="button"
              data-disclaimer-dismiss="true"
              aria-label="{{ disclaimerData.dismissLabel | default('Dismiss alert') }}"
            >
              {{ renderIcon({
                  name: disclaimerData.closeIconName,
                  datas: options.iconDatas
              }) }}
            </button>
          {% endif %}
        </div>

        {# Action button label (for future Phase 4 if needed) #}
        {% if disclaimerData.actionLabel %}
          <div data-disclaimer-action="true" aria-hidden="true">
            {{ disclaimerData.actionLabel }}
          </div>
        {% endif %}
      </div>
    {% endif %}
  {% endif %}
{% endmacro %}

{#
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
May your bugs be forever exiled to the shadow realm ✦
Charlotte Carpentier · 2025
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
#}

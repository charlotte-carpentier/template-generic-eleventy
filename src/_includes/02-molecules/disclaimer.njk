{# ┌─────────────────────────────────────────────────────────┐
   │ MOLECULE › Disclaimer                                   │
   │ Alert messages with semantic variants and actions       │
   └─────────────────────────────────────────────────────────┘ #}

{#
  Props:
    - options.name (string): Disclaimer identifier
    - options.datas (array): Disclaimer configuration data
    - options.iconDatas (array): Icon atom data

  Usage — Summon HAT Components Wisely:
    {% from "02-molecules/disclaimer.njk" import renderDisclaimer %}

    {{ renderDisclaimer({
        name: "demoDiscla1",
        datas: molecules.disclaimer.disclaimers,
        iconDatas: atoms.icon.icons
    }) }}

  JavaScript: utils/dismiss.js

  @created 2025-01-15
#}

{% from "01-atoms/icon.njk" import renderIcon %}

{% macro renderDisclaimer(options) %}

  {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
    1. Validate Props
  ━━━━━━━━━━━━━━━━━━━━━━━━━ #}
  {% if not options.datas %}
    <span class="error" role="alert">Error: Missing required prop (datas)</span>
  {% elif not options.name %}
    <span class="error" role="alert">Error: Missing required prop (name)</span>
  {% else %}
    {# Find disclaimer using universal filter #}
    {% set disclaimerData = options.datas | findByName(options.name) %}

    {# Render disclaimer or error message #}
    {% if not disclaimerData %}
      <span class="error" role="alert">Disclaimer not found: {{ options.name }}</span>
    {% else %}

      {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
        2. Compute Final Values
      ━━━━━━━━━━━━━━━━━━━━━━━━━ #}
      {% set variant = disclaimerData.variant | default('info') %}
      {% set message = disclaimerData.message | default('') %}
      {% set iconName = disclaimerData.iconName | default('') %}
      {% set closeIconName = disclaimerData.closeIconName | default('') %}
      {% set dismissLabel = disclaimerData.dismissLabel | default('Dismiss alert') %}

      {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
        3. Tailwind Classes
        Index:
        3.1 Wrapper Classes
        3.2 Content Wrapper Classes
        3.3 Icon Wrapper Classes
        3.4 Message Classes
        3.5 Close Button Classes
      ━━━━━━━━━━━━━━━━━━━━━━━━━ #}

      {# --------------------------
          3.1 Wrapper Classes
          Description: Layout, Background, Borders
        --------------------------#}
      {% set containerBaseClasses = "flex flex-col w-full rounded-[var(--radius-card)] border-2 p-[var(--spacing-inset-small)]" %}

      {% set containerVariantMap = {
        'info': 'bg-[var(--color-semantic-information-contrast-light-02)] border-[var(--color-semantic-information)]',
        'success': 'bg-[var(--color-semantic-success-contrast-light-02)] border-[var(--color-semantic-success)]',
        'warning': 'bg-[var(--color-semantic-warning-contrast-light-02)] border-[var(--color-semantic-warning)]',
        'error': 'bg-[var(--color-semantic-critical-contrast-light-02)] border-[var(--color-semantic-critical)]'
      } %}
      {% set containerVariantClasses = containerVariantMap[variant] | default(containerVariantMap['info']) %}

      {% set containerClasses = containerBaseClasses ~ " " ~ containerVariantClasses %}

      {# --------------------------
          3.2 Content Wrapper Classes
          Description: Layout horizontal, Spacing, Alignment
        --------------------------#}
      {% set contentWrapperClasses = "flex items-center gap-[var(--spacing-inline-medium)]" %}

      {# --------------------------
          3.3 Icon Wrapper Classes
          Description: Layout, Colors
        --------------------------#}
      {% set iconWrapperBaseClasses = "flex-shrink-0 inline-flex items-center" %}

      {% set iconColorMap = {
        'info': 'text-[var(--color-semantic-information)]',
        'success': 'text-[var(--color-semantic-success)]',
        'warning': 'text-[var(--color-semantic-warning)]',
        'error': 'text-[var(--color-semantic-critical)]'
      } %}
      {% set iconColorClasses = iconColorMap[variant] | default(iconColorMap['info']) %}

      {% set iconWrapperClasses = iconWrapperBaseClasses ~ " " ~ iconColorClasses %}

      {# --------------------------
          3.4 Message Classes
          Description: Typography, Colors, Layout
        --------------------------#}
      {% set messageClasses = "font-body text-body text-[var(--color-global-default)] flex-1" %}

      {# --------------------------
          3.5 Close Button Classes
          Description: Layout, Colors, States, Spacing
        --------------------------#}
      {% set closeButtonClasses = "flex-shrink-0 inline-flex items-center justify-center min-w-[24px] min-h-[24px] w-6 h-6 ml-[var(--spacing-inline-large)] text-[var(--color-global-default)] bg-transparent border-0 cursor-pointer transition-colors hover:text-[var(--color-global-contrast-light-01)] focus:outline-none focus:ring-2 focus:ring-[var(--color-semantic-information-focus)] focus:ring-offset-2" %}

      {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
        4. Render HTML
      ━━━━━━━━━━━━━━━━━━━━━━━━━ #}
      <div
        class="{{ containerClasses }}"
        data-dismissible
        data-disclaimer-name="{{ disclaimerData.name }}"
        data-disclaimer-type="disclaimer"
        data-disclaimer-variant="{{ variant }}"
        role="alert"
        aria-live="polite"
      >
        <div
          class="{{ contentWrapperClasses }}"
          data-disclaimer-content="true"
        >
          {# Icon (if present) #}
          {% if iconName and options.iconDatas %}
            <div
              class="{{ iconWrapperClasses }}"
              data-disclaimer-icon="true"
            >
              {{ renderIcon({
                  name: iconName,
                  datas: options.iconDatas,
                  decorative: true
              }) }}
            </div>
          {% endif %}

          {# Message #}
          <span
            class="{{ messageClasses }}"
            data-disclaimer-message="true"
          >
            {{ message }}
          </span>

          {# Close button (if present) #}
          {% if closeIconName and options.iconDatas %}
            <button
              type="button"
              class="{{ closeButtonClasses }}"
              data-dismiss
              aria-label="{{ dismissLabel }}"
            >
              {{ renderIcon({
                  name: closeIconName,
                  datas: options.iconDatas,
                  decorative: true
              }) }}
            </button>
          {% endif %}
        </div>
      </div>
    {% endif %}
  {% endif %}
{% endmacro %}

{#
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
May your bugs be forever exiled to the shadow realm ✦
HAT · 2026
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
#}

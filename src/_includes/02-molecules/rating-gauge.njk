{# ┌─────────────────────────────────────────────────────────┐
   │ MOLECULE › Rating Gauge                                 │
   │ Star rating display with customizable icons             │
   └─────────────────────────────────────────────────────────┘ #}

{#
  Props:
    - options.name (string): Rating gauge identifier
    - options.datas (array): Rating gauge configuration data
    - options.iconDatas (array): Icon atom data
    - options.showValue (boolean): Display numeric value (optional)

  Usage — Summon HAT Components Wisely:
    {% from "02-molecules/rating-gauge.njk" import renderRatingGauge %}

    {{ renderRatingGauge({
        name: "demoRating1",
        datas: molecules["rating-gauge"].ratingGauges,
        iconDatas: atoms.icon.icons
    }) }}

  @created 2025-01-15
#}

{% from "01-atoms/icon.njk" import renderIcon %}

{% macro renderRatingGauge(options) %}
  {# Validate required props #}
  {% if not options.datas %}
    <span class="error" role="alert">Error: Missing required prop (datas)</span>
  {% elif not options.name %}
    <span class="error" role="alert">Error: Missing required prop (name)</span>
  {% else %}
    {# Find rating gauge using universal filter #}
    {% set ratingData = options.datas | findByName(options.name) %}

    {# Render or error #}
    {% if not ratingData %}
      <span class="error" role="alert">Rating gauge not found: {{ options.name }}</span>
    {% else %}
      <div
        data-rating-name="{{ ratingData.name }}"
        data-rating-type="rating-gauge"
        data-rating-value="{{ ratingData.rating }}"
        data-rating-max="{{ ratingData.maxRating }}"
      >
        {# Stars - generate based on rating and maxRating #}
        <div data-rating-stars="true">
          {% for i in range(0, ratingData.maxRating) %}
            <span data-rating-star="{% if i < ratingData.rating %}filled{% else %}empty{% endif %}">
              {{ renderIcon({
                  name: ratingData.iconName,
                  datas: options.iconDatas
              }) }}
            </span>
          {% endfor %}
        </div>

        {# Numeric value (if showValue enabled) #}
        {% if options.showValue %}
          <span data-rating-value="true">
            {{ ratingData.rating }}/{{ ratingData.maxRating }}
          </span>
        {% endif %}
      </div>
    {% endif %}
  {% endif %}
{% endmacro %}

{#
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
May your bugs be forever exiled to the shadow realm ✦
Charlotte Carpentier · 2025
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
#}

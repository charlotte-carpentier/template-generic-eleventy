{# ┌─────────────────────────────────────────────────────────┐
   │ MOLECULE › List Form                                    │
   │ Form input lists with ordered items                     │
   └─────────────────────────────────────────────────────────┘ #}

{#
  Props:
    - options.id (string): List form identifier
    - options.datas (array): List form configuration data
    - options.inputDatas (array): Input atom data

  Usage — Summon HAT Components Wisely:
    {% from "02-molecules/list-form.njk" import renderListForm %}

    {{ renderListForm({
        id: "demoForm1",
        datas: molecules["list-form"].listForms,
        inputDatas: atoms.input.inputs
    }) }}

  @created 2025-01-15
#}

{% from "01-atoms/input.njk" import renderInput %}

{% macro renderListForm(options) %}

  {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
    1. Validate Props
  ━━━━━━━━━━━━━━━━━━━━━━━━━ #}
  {% if not options.datas %}
    <span class="error" role="alert">Error: Missing required prop (datas)</span>
  {% elif not options.id %}
    <span class="error" role="alert">Error: Missing required prop (id)</span>
  {% else %}
    {# Find list form using universal filter #}
    {% set listFormData = options.datas | findByName(options.id) %}

    {# Render list form or error message #}
    {% if not listFormData %}
      <span class="error" role="alert">List form not found: {{ options.id }}</span>
    {% else %}

      {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
        2. Compute Final Values
      ━━━━━━━━━━━━━━━━━━━━━━━━━ #}
      {% set listId = listFormData.id | default(options.id) %}
      {% set listType = listFormData.type | default('input-list') %}
      {% set items = listFormData.items | default([]) %}

      {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
        3. Tailwind Classes
        Index:
        3.1 Wrapper Classes
        3.2 Item Classes
      ━━━━━━━━━━━━━━━━━━━━━━━━━ #}

      {# --------------------------
          3.1 Wrapper Classes
          Description: Layout vertical, Spacing
        --------------------------#}
      {% set containerClasses = "flex flex-col gap-[var(--spacing-6)]" %}

      {# --------------------------
          3.2 Item Classes
          Description: Layout
        --------------------------#}
      {% set itemClasses = "w-full" %}

      {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
        4. Render HTML
      ━━━━━━━━━━━━━━━━━━━━━━━━━ #}
      <div
        class="{{ containerClasses }}"
        data-list-form-id="{{ listId }}"
        data-list-form-type="{{ listType }}"
      >
        {% for item in items %}
          <div
            class="{{ itemClasses }}"
            data-list-form-item="{{ item.order }}"
          >
            {# Render input #}
            {{ renderInput({
                name: item.inputName,
                datas: options.inputDatas
            }) }}
          </div>
        {% endfor %}
      </div>
    {% endif %}
  {% endif %}
{% endmacro %}

{#
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
May your bugs be forever exiled to the shadow realm ✦
HAT · 2025
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
#}

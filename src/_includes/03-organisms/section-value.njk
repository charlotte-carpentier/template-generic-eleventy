{# ┌─────────────────────────────────────────────────────────┐
   │ ORGANISM › Section Value                                │
   │ Value proposition section with simple or cards layout   │
   └─────────────────────────────────────────────────────────┘ #}

{#
  Props:
    - options.name (string): Section identifier
    - options.datas (array): Section configuration data
    - options.headingDatas (array): Heading atom data
    - options.buttonDatas (array): Button atom data
    - options.cardDatas (array): Card molecule data (for type="cards")
    - options.lockupDatas (array): Lockup molecule data (for cards)
    - options.imageDatas (array): Image atom data (for cards)
    - options.iconDatas (array): Icon atom data (for cards)

  Usage — Summon HAT Components Wisely:
    {% from "03-organisms/section-value.njk" import renderSectionValue %}

    Simple layout:
    {{ renderSectionValue({
        name: "demoSectV1",
        datas: organisms["section-value"].sectValues,
        headingDatas: atoms.heading.headings,
        buttonDatas: atoms.button.buttons
    }) }}

    Cards layout:
    {{ renderSectionValue({
        name: "demoSectV2",
        datas: organisms["section-value"].sectValues,
        headingDatas: atoms.heading.headings,
        cardDatas: molecules.card.cards,
        lockupDatas: molecules["lock-up"].lockUps,
        imageDatas: atoms.image.images,
        buttonDatas: atoms.button.buttons,
        iconDatas: atoms.icon.icons
    }) }}

  @created 2025-01-15
#}

{% macro renderSectionValue(options) %}
  {# Import sub-components #}
  {% from "01-atoms/heading.njk" import renderHeading %}
  {% from "01-atoms/button.njk" import renderButton %}
  {% from "02-molecules/card.njk" import renderCard %}

  {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
    1. Validate Props
  ━━━━━━━━━━━━━━━━━━━━━━━━━ #}
  {% if not options.datas %}
    <span class="error" role="alert">Error: Missing required prop (datas)</span>
  {% elif not options.name %}
    <span class="error" role="alert">Error: Missing required prop (name)</span>
  {% else %}
    {# Find section using universal filter #}
    {% set sectionData = options.datas | findByName(options.name) %}

    {# Render section or error message #}
    {% if not sectionData %}
      <span class="error" role="alert">Section not found: {{ options.name }}</span>
    {% else %}

      {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
        2. Compute Final Values
      ━━━━━━━━━━━━━━━━━━━━━━━━━ #}
      {% set sectionName = sectionData.name | default(options.name) %}
      {% set sectionType = sectionData.type | default('simple') %}
      {% set superHeadingName = sectionData.superHeadingName | default('') %}
      {% set mainHeadingName = sectionData.mainHeadingName | default('') %}
      {% set content = sectionData.content | default('') %}
      {% set primaryButtonName = sectionData.primaryButtonName | default('') %}
      {% set secondaryButtonName = sectionData.secondaryButtonName | default('') %}
      {% set cardTags = sectionData.cardTags | default([]) %}
      {% set ariaLabel = sectionData.ariaLabel | default('Value section') %}

      {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
        3. Tailwind Classes
        Index:
        3.1 Section Wrapper Classes
        3.2 Content Wrapper Classes
        3.3 Header Wrapper Classes
        3.4 Super Heading Wrapper Classes
        3.5 Main Heading Wrapper Classes
        3.6 Text Wrapper Classes
        3.7 Buttons Wrapper Classes
        3.8 Cards Grid Wrapper Classes
      ━━━━━━━━━━━━━━━━━━━━━━━━━ #}

      {# --------------------------
          3.1 Section Wrapper Classes
          Description: Layout, Spacing, Background
        --------------------------#}
      {% set sectionClasses = "flex flex-col px-[var(--spacing-inset-medium)] py-[var(--spacing-inset-large)] bg-[var(--color-global-white)] md:px-[var(--spacing-inset-xlarge)] md:py-[var(--spacing-inset-xxlarge)]" %}

      {# --------------------------
          3.2 Content Wrapper Classes
          Description: Layout vertical, Spacing, Max-width centered for simple type
        --------------------------#}
      {% if sectionType == 'simple' %}
        {% set containerClasses = "flex flex-col gap-[var(--spacing-stack-xlarge)] mx-auto max-w-[800px]" %}
      {% else %}
        {% set containerClasses = "flex flex-col gap-[var(--spacing-stack-xlarge)]" %}
      {% endif %}

      {# --------------------------
          3.3 Header Wrapper Classes
          Description: Layout vertical, Spacing between headings
      --------------------------#}
      {% if sectionType == 'simple' %}
        {% set headerClasses = "flex flex-col gap-[var(--spacing-stack-tight)]" %}
      {% else %}
        {% set headerClasses = "flex flex-col gap-[var(--spacing-stack-medium)]" %}
      {% endif %}

      {# --------------------------
          3.4 Super Heading Wrapper Classes
          Description: Layout, Alignment
      --------------------------#}
      {% if sectionType == 'simple' %}
        {% set superHeadingClasses = "flex flex-col items-center" %}
      {% else %}
        {% set superHeadingClasses = "flex flex-col items-start md:items-center" %}
      {% endif %}

      {# --------------------------
          3.5 Main Heading Wrapper Classes
          Description: Layout, Typography override serif, Alignment, Spacing bottom
      --------------------------#}
      {% if sectionType == 'simple' %}
        {% set mainHeadingClasses = "flex flex-col items-center mt-[var(--spacing-stack-large)] [&_h1]:typography-h1-serif [&_h2]:typography-h2-serif [&_h3]:typography-h3-serif" %}
      {% else %}
        {% set mainHeadingClasses = "flex flex-col items-start mt-[var(--spacing-stack-large)] md:items-center [&_h1]:typography-h1-serif [&_h2]:typography-h2-serif [&_h3]:typography-h3-serif" %}
      {% endif %}

      {# --------------------------
          3.6 Text Wrapper Classes
          Description: Typography, Colors, Alignment centered
        --------------------------#}
      {% set textClasses = "typography-body-regular text-[var(--color-global-default)] text-center" %}

      {# --------------------------
          3.7 Buttons Wrapper Classes
          Description: Layout horizontal, Spacing, Alignment centered
        --------------------------#}
      {% set buttonsClasses = "flex gap-[var(--spacing-inline-large)] justify-center" %}

      {# --------------------------
          3.8 Cards Grid Wrapper Classes
          Description: Layout responsive grid, Spacing, Override card gaps, text, button wrapper and button style
      --------------------------#}
      {% set cardsGridClasses = "grid grid-cols-1 gap-[var(--spacing-stack-large)] md:grid-cols-3 md:gap-[var(--spacing-stack-xlarge)] [&>*]:w-full [&>*]:max-w-none [&_[data-card-text]]:line-clamp-none [&_[data-card-content]]:gap-[var(--spacing-stack-medium)] [&_div[class*='mt-0']]:mt-0 [&_div[class*='mt-0']_button]:w-auto [&_div[class*='mt-0']_button]:max-w-fit [&_button]:bg-[var(--color-button-primary)] [&_button]:text-white [&_button]:border-0 [&_button:hover]:bg-[var(--color-button-primary-hover)]" %}

      {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
        4. Render HTML
      ━━━━━━━━━━━━━━━━━━━━━━━━━ #}
      <section
        class="{{ sectionClasses }}"
        aria-label="{{ ariaLabel }}"
        data-section-name="{{ sectionName }}"
        data-section-type="section-value"
        data-section-variant="{{ sectionType }}"
      >

        <div
          class="{{ containerClasses }}"
          data-section-container
        >

          {# Header area - Common to both types #}
          <div
            class="{{ headerClasses }}"
            data-section-header
          >

            {# Super heading - Small title #}
            {% if superHeadingName %}
              <div
                class="{{ superHeadingClasses }}"
                data-section-super-heading
              >
                {{ renderHeading({
                    name: superHeadingName,
                    datas: options.headingDatas
                }) }}
              </div>
            {% endif %}

            {# Main heading - Large serif title #}
            {% if mainHeadingName %}
              <div
                class="{{ mainHeadingClasses }}"
                data-section-main-heading
              >
                {{ renderHeading({
                    name: mainHeadingName,
                    datas: options.headingDatas
                }) }}
              </div>
            {% endif %}

          </div>

          {# Content area - Depends on type #}
          {% if sectionType == "simple" %}

            {# Simple type: content + buttons centered #}
            <div
              class="flex flex-col gap-[var(--spacing-6)]"
              data-section-content
            >

              {# Content text #}
              {% if content %}
                <div
                  class="{{ textClasses }}"
                  data-section-text
                >
                  <p>{{ content }}</p>
                </div>
              {% endif %}

              {# Call-to-action buttons #}
              {% if primaryButtonName or secondaryButtonName %}
                <div
                  class="{{ buttonsClasses }}"
                  data-section-buttons
                >

                  {# Primary button #}
                  {% if primaryButtonName %}
                    {{ renderButton({
                        name: primaryButtonName,
                        datas: options.buttonDatas
                    }) }}
                  {% endif %}

                  {# Secondary button #}
                  {% if secondaryButtonName %}
                    {{ renderButton({
                        name: secondaryButtonName,
                        datas: options.buttonDatas
                    }) }}
                  {% endif %}

                </div>
              {% endif %}

            </div>

          {% elif sectionType == "cards" %}

            {# Cards type: grid of 3 cards #}
            <div
              class="{{ cardsGridClasses }}"
              data-section-cards
            >
              {% if cardTags and options.cardDatas %}
                {# Display 3 cards for demo - Repeat cards to fill grid #}
                {% set displayedCards = 0 %}
                {% for n in range(0, 3) %}
                  {% for card in options.cardDatas %}
                    {% if card.tags and displayedCards < 3 %}
                      {% for tag in cardTags %}
                        {% if tag in card.tags and displayedCards < 3 %}
                          {{ renderCard({
                              name: card.id,
                              datas: options.cardDatas,
                              lockupDatas: options.lockupDatas,
                              imageDatas: options.imageDatas,
                              headingDatas: options.headingDatas,
                              buttonDatas: options.buttonDatas,
                              iconDatas: options.iconDatas
                          }) }}
                          {% set displayedCards = displayedCards + 1 %}
                        {% endif %}
                      {% endfor %}
                    {% endif %}
                  {% endfor %}
                {% endfor %}
              {% endif %}
            </div>

          {% endif %}

        </div>

      </section>
    {% endif %}
  {% endif %}
{% endmacro %}

{#
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
May your bugs be forever exiled to the shadow realm ✦
HAT · 2025
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
#}

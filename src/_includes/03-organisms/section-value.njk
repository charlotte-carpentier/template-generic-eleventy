{# ┌─────────────────────────────────────────────────────────┐
   │ ORGANISM › Section Value                                │
   │ Value proposition section with simple or cards layout   │
   └─────────────────────────────────────────────────────────┘ #}

{#
  Usage — Summon HAT Components Wisely:
    {% from "03-organisms/section-value.njk" import renderSectionValue %}

    Simple layout:
    {{ renderSectionValue({
        name: "demoSectV1",
        datas: organisms["section-value"].sectValues,
        headingDatas: atoms.heading.headings,
        buttonDatas: atoms.button.buttons
    }) }}

    Cards layout:
    {{ renderSectionValue({
        name: "demoSectV2",
        datas: organisms["section-value"].sectValues,
        headingDatas: atoms.heading.headings,
        cardDatas: molecules.card.cards,
        lockupDatas: molecules["lock-up"].lockUps,
        imageDatas: atoms.image.images,
        buttonDatas: atoms.button.buttons,
        iconDatas: atoms.icon.icons
    }) }}

  @created 2025-09-15
#}

{% macro renderSectionValue(options) %}
  {# Import sub-components #}
  {% from "01-atoms/heading.njk" import renderHeading %}
  {% from "01-atoms/button.njk" import renderButton %}
  {% from "02-molecules/card.njk" import renderCard %}

  {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
    1. Validate Props
  ━━━━━━━━━━━━━━━━━━━━━━━━━ #}
  {% if not options.datas %}
    <span class="error" role="alert">Error: Missing required prop (datas)</span>
  {% elif not options.name %}
    <span class="error" role="alert">Error: Missing required prop (name)</span>
  {% else %}
    {# Find section using universal filter #}
    {% set sectionData = options.datas | findByName(options.name) %}

    {# Render section or error message #}
    {% if not sectionData %}
      <span class="error" role="alert">Section not found: {{ options.name }}</span>
    {% else %}

      {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
        2. Compute Final Values
      ━━━━━━━━━━━━━━━━━━━━━━━━━ #}
      {% set sectionName = sectionData.name | default(options.name) %}
      {% set sectionType = sectionData.type | default('simple') %}
      {% set headingName = sectionData.headingName | default('') %}
      {% set subheadingName = sectionData.subheadingName | default('') %}
      {% set content = sectionData.content | default('') %}
      {% set primaryButtonName = sectionData.primaryButtonName | default('') %}
      {% set secondaryButtonName = sectionData.secondaryButtonName | default('') %}
      {% set cardTags = sectionData.cardTags | default([]) %}
      {% set ariaLabel = sectionData.ariaLabel | default('Value section') %}

      {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
        3. Tailwind Classes
        Index:
        3.1 Wrapper Classes
        3.2 Layout Classes (by type)
        3.3 Header Wrapper Classes (by type)
        3.4 Heading Wrapper Classes (by type)
        3.5 Subheading Wrapper Classes (by type)
        3.6 Text Wrapper Classes
        3.7 Buttons Wrapper Classes
        3.8 Content Wrapper Classes (simple type)
        3.9 Cards Grid Classes
      ━━━━━━━━━━━━━━━━━━━━━━━━━ #}

      {# --------------------------
          3.1 Wrapper Classes
          Description: Layout, Spacing, Background
        --------------------------#}
      {% set sectionClasses = "spacing-section-fluid-y" %}

      {# --------------------------
          3.2 Layout Classes (by type)
          Description: Layout vertical, Spacing, Max-width for simple type
        --------------------------#}
      {% set containerClasses = "w-full max-w-[var(--grid-workzone-mobile)] md:max-w-[var(--grid-workzone-desktop)] mx-auto" %}
      {% set gridMap = {
        'simple': 'flex flex-col gap-[var(--spacing-ui-maximal)]',
        'cards': 'flex flex-col gap-[var(--spacing-ui-maximal)]'
      } %}
      {% set gridClasses = gridMap[sectionType] or gridMap['simple'] %}

      {# --------------------------
          3.3 Header Wrapper Classes (by type)
          Description: Layout vertical, Spacing between headings
        --------------------------#}
      {% set headerMap = {
        'simple': 'flex flex-col gap-[var(--spacing-ui-maximal)]',
        'cards': 'flex flex-col gap-[var(--spacing-section-minimal)]'
      } %}
      {% set headerClasses = headerMap[sectionType] or headerMap['simple'] %}

      {# --------------------------
          3.4 Heading Wrapper Classes (by type)
          Description: Layout, Alignment
        --------------------------#}
      {% set headingMap = {
        'simple': 'flex flex-col items-center [&_h2]:font-heading-serif [&_h2]:text-fluid-h2',
        'cards': 'flex flex-col items-start md:items-center [&_h2]:font-heading-serif [&_h2]:text-fluid-h2'
      } %}
      {% set headingClasses = headingMap[sectionType] or headingMap['simple'] %}

      {# --------------------------
          3.5 Subheading Wrapper Classes (by type)
          Description: Layout, Typography override serif, Alignment, Spacing bottom
        --------------------------#}
      {% set subheadingMap = {
        'simple': 'flex flex-col items-center [&_h3]:font-heading-bold-serif [&_h3]:text-fluid-h1',
        'cards': 'flex flex-col items-start md:items-center [&_h3]:font-heading-bold-serif [&_h3]:text-fluid-h1'
      } %}
      {% set subheadingClasses = subheadingMap[sectionType] or subheadingMap['simple'] %}

      {# --------------------------
          3.6 Text Wrapper Classes
          Description: Typography, Colors, Alignment centered
        --------------------------#}
      {% set textClasses = "font-body text-body text-[var(--color-global-default)] text-center max-w-prose" %}

      {# --------------------------
          3.7 Buttons Wrapper Classes
          Description: Layout horizontal, Spacing, Alignment centered
        --------------------------#}
      {% set buttonsClasses = "flex gap-[var(--spacing-ui-default)] justify-center" %}

      {# --------------------------
          3.8 Content Wrapper Classes (simple type)
          Description: Layout vertical, Spacing
        --------------------------#}
      {% set contentWrapperClasses = "flex flex-col gap-[var(--spacing-ui-comfortable)] max-w-prose mx-auto" %}

      {# --------------------------
          3.9 Cards Grid Classes
          Description: Layout responsive grid, Spacing, Override card gaps, text, button wrapper and button style
      --------------------------#}
      {% set cardsGridClasses = "grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-[var(--grid-gutter)] [&_[data-card-text]]:line-clamp-none [&_[data-card-content]]:gap-[var(--spacing-ui-default)] [&_div[class*='mt-0']]:mt-0 [&_div[class*='mt-0']_button]:w-auto [&_div[class*='mt-0']_button]:max-w-fit [&_button]:bg-[var(--color-button-primary)] [&_button]:text-white [&_button]:border-0 [&_button:hover]:bg-[var(--color-button-primary-hover)] [&>*]:max-w-[var(--grid-col-4)] [&>*]:mx-auto" %}

      {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
        4. Render HTML
      ━━━━━━━━━━━━━━━━━━━━━━━━━ #}
      <section
        class="{{ sectionClasses }}"
        aria-label="{{ ariaLabel }}"
        data-section-name="{{ sectionName }}"
        data-section-type="section-value"
        data-section-variant="{{ sectionType }}"
      >

        <div
          class="{{ containerClasses }}"
          data-section-container
        >

          <div
            class="{{ gridClasses }}"
            data-section-grid
          >

            {# Header area - Common to both types #}
            <div
              class="{{ headerClasses }}"
              data-section-header
            >

              {# Heading - Small title #}
              {% if headingName %}
                <div
                  class="{{ headingClasses }}"
                  data-section-heading
                >
                  {{ renderHeading({
                      name: headingName,
                      datas: options.headingDatas,
                      text: options.headingText
                  }) }}
                </div>
              {% endif %}

              {# Subheading - Large serif title #}
              {% if subheadingName %}
                <div
                  class="{{ subheadingClasses }}"
                  data-section-subheading
                >
                  {{ renderHeading({
                      name: subheadingName,
                      datas: options.headingDatas,
                      text: options.headingText
                  }) }}
                </div>
              {% endif %}

            </div>

            {# Content area - Depends on type #}
            {% if sectionType == "simple" %}

              {# Simple type: content + buttons centered #}
              <div
                class="{{ contentWrapperClasses }}"
                data-section-content
              >

                {# Content text #}
                {% if content %}
                  <div
                    class="{{ textClasses }}"
                    data-section-text
                  >
                    <p>{{ content }}</p>
                  </div>
                {% endif %}

                {# Call-to-action buttons #}
                {% if primaryButtonName or secondaryButtonName %}
                  <div
                    class="{{ buttonsClasses }}"
                    data-section-buttons
                  >

                    {# Primary button #}
                    {% if primaryButtonName %}
                      {{ renderButton({
                          name: primaryButtonName,
                          datas: options.buttonDatas,
                          url: options.buttonUrl,
                          iconDatas: options.iconDatas,
                          tooltipDatas: options.tooltipDatas
                      }) }}
                    {% endif %}

                    {# Secondary button #}
                    {% if secondaryButtonName %}
                      {{ renderButton({
                          name: secondaryButtonName,
                          datas: options.buttonDatas,
                          url: options.buttonUrl,
                          iconDatas: options.iconDatas,
                          tooltipDatas: options.tooltipDatas
                      }) }}
                    {% endif %}

                  </div>
                {% endif %}

              </div>

            {% elif sectionType == "cards" %}

              {# Cards type: grid of 3 cards #}
              <div
                class="{{ cardsGridClasses }}"
                data-section-cards
              >
                {% if cardTags and options.cardDatas %}
                  {# Filter cards by tags #}
                  {% set filteredCards = options.cardDatas | filterCardsByTags(cardTags, 3) %}
                  {% for card in filteredCards %}
                    {{ renderCard({
                        name: card.name,
                        datas: options.cardDatas,
                        lockupDatas: options.lockupDatas,
                        imageDatas: options.imageDatas,
                        headingDatas: options.headingDatas,
                        buttonDatas: options.buttonDatas,
                        iconDatas: options.iconDatas,
                        tooltipDatas: options.tooltipDatas
                    }) }}
                  {% endfor %}
                {% endif %}

              </div>

            {% endif %}

          </div>

        </div>

      </section>
    {% endif %}
  {% endif %}
{% endmacro %}

{#
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
May your bugs be forever exiled to the shadow realm ✦
HAT · 2026
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
#}

{# ┌─────────────────────────────────────────────────────────┐
   │ ORGANISM › Menu                                         │
   │ Navigation menu with heading and secondary navigation   │
   └─────────────────────────────────────────────────────────┘ #}

{#
  Props:
    - options.name (string): Menu identifier
    - options.datas (array): Menu configuration data
    - options.headingDatas (array): Heading atom data
    - options.navSecondaryDatas (array): Navigation secondary organism data
    - options.linkDatas (array): Link atom data

  Usage — Summon HAT Components Wisely:
    {% from "03-organisms/menu.njk" import renderMenu %}

    {{ renderMenu({
        name: "demoMenu1",
        datas: organisms.menu.menus,
        headingDatas: atoms.heading.headings,
        navSecondaryDatas: organisms["navigation-secondary"].navSecondarys,
        linkDatas: atoms.link.links
    }) }}

  @created 2025-01-15
#}

{% macro renderMenu(options) %}
  {# Import sub-components #}
  {% from "01-atoms/heading.njk" import renderHeading %}
  {% from "03-organisms/navigation-secondary.njk" import renderNavigationSecondary %}

  {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
    1. Validate Props
  ━━━━━━━━━━━━━━━━━━━━━━━━━ #}
  {% if not options.datas %}
    <span class="error" role="alert">Error: Missing required prop (datas)</span>
  {% elif not options.name %}
    <span class="error" role="alert">Error: Missing required prop (name)</span>
  {% else %}
    {# Find menu using universal filter #}
    {% set menuData = options.datas | findByName(options.name) %}

    {# Render menu or error message #}
    {% if not menuData %}
      <span class="error" role="alert">Menu not found: {{ options.name }}</span>
    {% else %}

      {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
        2. Compute Final Values
      ━━━━━━━━━━━━━━━━━━━━━━━━━ #}
      {% set menuName = menuData.name | default(options.name) %}
      {% set items = menuData.items | default([]) %}
      {% set ariaLabel = menuData.ariaLabel | default('Navigation menu') %}

      {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
        3. Tailwind Classes
        Index:
        3.1 Wrapper Classes
        3.2 Grid Classes
        3.3 Column Classes
        3.4 Link Classes
      ━━━━━━━━━━━━━━━━━━━━━━━━━ #}

      {# --------------------------
          3.1 Wrapper Classes
          Description: Layout, Spacing, Background
        --------------------------#}
      {% set navClasses = "flex p-[var(--spacing-inset-large)] bg-[var(--color-global-white)]" %}

      {# --------------------------
          3.2 Grid Classes
          Description: Layout grid responsive, Gap
        --------------------------#}
      {% set columnsClasses = "grid grid-cols-1 gap-y-[var(--spacing-stack-large)] gap-x-[var(--spacing-inline-large)] w-full md:grid-cols-2 lg:grid-cols-4" %}

      {# --------------------------
          3.3 Column Classes
          Description: Layout, Spacing
        --------------------------#}
      {% set columnClasses = "flex flex-col gap-[var(--spacing-stack-small)] px-[var(--spacing-inset-large)] [&_[data-column-heading]]:pl-[var(--spacing-inset-small)]" %}

      {# --------------------------
          3.4 Link Classes
          Description: Colors, States for links (remove bullet from nav-secondary)
      --------------------------#}
      {% set linkOverrideClasses = "[&_a]:text-[var(--color-global-default)] [&_a:hover]:text-[var(--color-global-contrast-light-01)] [&_a:hover]:before:content-none [&_a:focus]:text-[var(--color-global-contrast-light-01)] [&_a:focus]:underline [&_a[aria-current]]:text-[var(--color-global-contrast-light-03)] [&_a[aria-disabled='true']]:text-[var(--color-global-contrast-light-03)]" %}

      {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
        4. Render HTML
      ━━━━━━━━━━━━━━━━━━━━━━━━━ #}
      <nav
        class="{{ navClasses }}"
        aria-label="{{ ariaLabel }}"
        data-menu-name="{{ menuName }}"
        data-menu-type="menu"
      >

        {# Menu items - Column layout pattern #}
        <div
          class="{{ columnsClasses }} {{ linkOverrideClasses }}"
          data-menu-columns
        >
          {% for item in items %}
            <div
              class="{{ columnClasses }}"
              data-menu-column
            >

              {# Column heading #}
              <div data-column-heading>
                {{ renderHeading({
                    name: item.headingName,
                    datas: options.headingDatas
                }) }}
              </div>

              {# Column navigation #}
              {{ renderNavigationSecondary({
                  name: item.navSecondaryName,
                  datas: options.navSecondaryDatas,
                  linkDatas: options.linkDatas
              }) }}

            </div>
          {% endfor %}
        </div>

      </nav>
    {% endif %}
  {% endif %}
{% endmacro %}

{#
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
May your bugs be forever exiled to the shadow realm ✦
HAT · 2025
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
#}

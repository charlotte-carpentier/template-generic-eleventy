{# ┌─────────────────────────────────────────────────────────┐
   │ ORGANISM › Header                                       │
   │ Site header with responsive desktop/mobile navigation   │
   └─────────────────────────────────────────────────────────┘ #}

{#
  Props:
    - options.name (string): Header identifier
    - options.datas (array): Header configuration data
    - options.vectorDatas (array): Vector atom data
    - options.iconDatas (array): Icon atom data
    - options.navigationDatas (array): Navigation organism data
    - options.linkDatas (array): Link atom data

  Usage — Summon HAT Components Wisely:
    {% from "03-organisms/header.njk" import renderHeader %}

    {{ renderHeader({
        name: "demoHeader1",
        datas: organisms.header.headers,
        vectorDatas: atoms.vector.vectors,
        iconDatas: atoms.icon.icons,
        navigationDatas: organisms.navigation.navigations,
        linkDatas: atoms.link.links
    }) }}

  JavaScript:
    - components/03-organisms/header.js
    - utils/debounce.js
    - utils/active-link.js

  @created 2025-01-15
  @updated 2023-01-20
#}

{% macro renderHeader(options) %}
  {# Import sub-components #}
  {% from "01-atoms/vector.njk" import renderVector %}
  {% from "01-atoms/icon.njk" import renderIcon %}
  {% from "03-organisms/navigation.njk" import renderNavigation %}

  {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
    1. Validate Props
  ━━━━━━━━━━━━━━━━━━━━━━━━━ #}
  {% if not options.datas %}
    <span class="error" role="alert">Error: Missing required prop (datas)</span>
  {% elif not options.name %}
    <span class="error" role="alert">Error: Missing required prop (name)</span>
  {% else %}
    {# Find header using universal filter #}
    {% set headerData = options.datas | findByName(options.name) %}

    {# Render header or error message #}
    {% if not headerData %}
      <span class="error" role="alert">Header not found: {{ options.name }}</span>
    {% else %}

      {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
        2. Compute Final Values
      ━━━━━━━━━━━━━━━━━━━━━━━━━ #}
      {% set headerName = headerData.name | default(options.name) %}
      {% set desktopVectorName = headerData.desktop.vectorName | default('') %}
      {% set desktopNavigationName = headerData.desktop.navigationName | default('') %}
      {% set mobileVectorName = headerData.mobile.vectorName | default('') %}
      {% set burgerOpenIcon = headerData.mobile.burgerOpenIcon | default('') %}
      {% set burgerCloseIcon = headerData.mobile.burgerCloseIcon | default('') %}
      {% set hasOverlay = headerData.mobile.overlay | default(false) %}
      {% set ariaLabel = headerData.ariaLabel | default('Site header') %}

      {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
        3. Tailwind Classes
        Index:
        3.1 Wrapper Classes
        3.2 Layout Classes
        3.3 Desktop Branding Classes
        3.4 Desktop Navigation Classes
        3.5 Mobile Branding Classes
        3.6 Mobile Burger Button Classes
        3.7 Mobile Overlay Backdrop Classes
        3.8 Mobile Overlay Drawer Classes
        3.9 Mobile Overlay Content Classes
      ━━━━━━━━━━━━━━━━━━━━━━━━━ #}

      {# --------------------------
          3.1 Wrapper Classes
          Description: Layout, Spacing, Background, Borders, Responsive
        --------------------------#}
      {% set headerClasses = "flex flex-col px-[var(--spacing-inset-large)] md:px-[var(--spacing-fluid-md)] py-[var(--spacing-stack-medium)] md:py-[var(--spacing-stack-large)] bg-[var(--color-global-white)] border-b border-[var(--color-global-contrast-light-03)]" %}

      {# --------------------------
          3.2 Layout Classes
          Description: Layout flex horizontal, Space-between, Alignment
        --------------------------#}
      {% set innerContainerClasses = "flex items-center justify-between w-full" %}

      {# --------------------------
          3.3 Desktop Branding Classes
          Description: Layout, Responsive visibility (hidden on mobile)
        --------------------------#}
      {% set desktopBrandingClasses = "hidden md:flex" %}

      {# --------------------------
          3.4 Desktop Navigation Classes
          Description: Layout, Responsive visibility (hidden on mobile)
        --------------------------#}
      {% set desktopNavClasses = "hidden md:flex" %}

      {# --------------------------
          3.5 Mobile Branding Classes
          Description: Layout, Responsive visibility (visible on mobile only)
        --------------------------#}
      {% set mobileBrandingHeaderClasses = "flex md:hidden" %}

      {# --------------------------
          3.6 Mobile Burger Button Classes
          Description: Layout, Spacing, States, Responsive visibility (hidden on desktop)
        --------------------------#}
      {% set burgerClasses = "flex items-center justify-center p-[var(--spacing-inset-small)] bg-transparent border-none cursor-pointer transition-colors hover:bg-[var(--color-global-contrast-light-04)] focus:outline focus:outline-2 focus:outline-[var(--color-semantic-information-focus)] rounded-[var(--radius-default)] md:hidden" %}

      {# --------------------------
          3.7 Mobile Overlay Backdrop Classes
          Description: Fixed fullscreen, Semi-transparent overlay, Z-index below drawer
        --------------------------#}
      {% set backdropClasses = "fixed inset-0 z-40 bg-black/50 hidden" %}

      {# --------------------------
          3.8 Mobile Overlay Drawer Classes
          Description: Drawer from left 80% width, Shadow, Slide animation, Z-index above backdrop
        --------------------------#}
      {% set drawerClasses = "fixed top-0 left-0 h-full w-4/5 z-50 bg-[var(--color-global-white)] shadow-[var(--elevation-floating)] transition-transform duration-300 -translate-x-full hidden" %}

      {# --------------------------
          3.9 Mobile Overlay Content Classes
          Description: Layout, Spacing, Scroll behavior
        --------------------------#}
      {% set overlayContentClasses = "flex flex-col gap-[var(--spacing-stack-large)] p-[var(--spacing-inset-large)] h-full overflow-y-auto" %}

      {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
        4. Render HTML
      ━━━━━━━━━━━━━━━━━━━━━━━━━ #}
      <header
        class="{{ headerClasses }}"
        id="main-header"
        aria-label="{{ ariaLabel }}"
        data-header-name="{{ headerName }}"
        data-header-type="header"
      >

        <div
          class="{{ innerContainerClasses }}"
          data-header-container
        >

          {# Desktop branding - Vector logo #}
          <div
            class="{{ desktopBrandingClasses }}"
            data-header-section="desktop-branding"
          >
            {{ renderVector({
                name: desktopVectorName,
                datas: options.vectorDatas
            }) }}
          </div>

          {# Desktop navigation #}
          <div
            class="{{ desktopNavClasses }}"
            data-header-section="desktop-navigation"
          >
            {{ renderNavigation({
                name: desktopNavigationName,
                datas: options.navigationDatas,
                linkDatas: options.linkDatas
            }) }}
          </div>

          {# Mobile branding - Vector logo (visible on mobile only) #}
          <div
            class="{{ mobileBrandingHeaderClasses }}"
            data-header-section="mobile-branding"
          >
            {{ renderVector({
                name: mobileVectorName,
                datas: options.vectorDatas
            }) }}
          </div>

          {# Mobile burger button #}
          <button
            class="{{ burgerClasses }}"
            id="burger-toggle"
            type="button"
            aria-label="Toggle mobile menu"
            aria-expanded="false"
            aria-controls="mobile-overlay"
            data-header-burger
          >
            {# Burger open icon - visible by default #}
            <span data-burger-icon="open" aria-hidden="true">
              {{ renderIcon({
                  name: burgerOpenIcon,
                  datas: options.iconDatas
              }) }}
            </span>

            {# Burger close icon - hidden by default #}
            <span class="hidden" data-burger-icon="close" aria-hidden="true">
              {{ renderIcon({
                  name: burgerCloseIcon,
                  datas: options.iconDatas
              }) }}
            </span>
          </button>

        </div>

        {# Mobile overlay - Backdrop + Drawer #}
        {% if hasOverlay %}
          {# Backdrop (click to close) #}
          <div
            class="{{ backdropClasses }}"
            id="mobile-backdrop"
            aria-hidden="true"
            data-header-backdrop
          ></div>

          {# Drawer navigation #}
          <div
            class="{{ drawerClasses }}"
            id="mobile-overlay"
            role="region"
            aria-label="Main menu"
            data-header-overlay
          >
            <div
              class="{{ overlayContentClasses }}"
              data-overlay-content
            >

              {# Mobile navigation #}
              {{ renderNavigation({
                    name: desktopNavigationName,
                    datas: options.navigationDatas,
                    linkDatas: options.linkDatas
              }) }}

            </div>
          </div>
        {% endif %}

      </header>
    {% endif %}
  {% endif %}
{% endmacro %}

{#
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
May your bugs be forever exiled to the shadow realm ✦
HAT · 2026
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
#}

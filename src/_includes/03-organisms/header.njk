{# ┌─────────────────────────────────────────────────────────┐
   │ ORGANISM › Header                                       │
   │ Site header with brand, title and navigation            │
   └─────────────────────────────────────────────────────────┘ #}

{#
  Usage — Summon HAT Components Wisely:
    {% from "03-organisms/header.njk" import renderHeader %}
    {{ renderHeader({ 
        name: "charlotte_header",
        datas: organisms.header.headers,
        typographyDatas: atoms.typography.texts,
        tabMenuDatas: molecules["tab-menu"].tab_menus,
        linkDatas: atoms.link.links,
        iconDatas: atoms.icon.icons
    }) }}
  
  Props:
    - option.name (string): Header identifier
    - option.datas (array): Header configuration
    - option.typographyDatas (array): Typography atom data
    - option.tabMenuDatas (object): Tab menu molecule data
    - option.linkDatas (array): Links atom data
    - option.iconDatas (array): Icons atom data
    - option.class (string): Additional CSS classes
  
  Features:
    - Brand logo using typography
    - Desktop title (hidden on mobile)
    - Desktop navigation link
    - Mobile burger menu with overlay
    - Tab menu in mobile overlay
  
  Accessibility:
    - Semantic <header> element
    - aria-label on burger button
    - aria-expanded state management
    - Keyboard accessible navigation
  
  @created 2025-01-15
#}

{% macro renderHeader(option) %}
  {# Import required molecules and atoms #}
  {% from "02-molecules/tab-menu.njk" import renderTabMenu %}
  {% from "01-atoms/heading.njk" import renderHeading %}
  {% from "01-atoms/link.njk" import renderLink %}
  {% from "01-atoms/icon.njk" import renderIcon %}

  {# Check if datas is provided #}
  {% if not option.datas %}
    <span>Error: No header configuration provided</span>
  {% else %}
    {# Retrieve header configuration #}
    {% set headersConfig = option.datas %}
    {% set headerName = option.name %}
    
    {# Find the specific header by name #}
    {% set headerData = null %}
    {% for header in headersConfig %}
      {% if header.name == headerName %}
        {% set headerData = header %}
      {% endif %}
    {% endfor %}

    {# Fallback if header not found #}
    {% if not headerData %}
      <span>Header not found: {{ headerName }}</span>
    {% else %}
      {# Build CSS classes #}
      {% set cssClasses = 'header' %}
      
      {# Add any additional classes #}
      {% if option.class %}
        {% set cssClasses = cssClasses ~ ' ' ~ option.class %}
      {% endif %}
      
      {# Header container #}
      <header class="{{ cssClasses }}" id="main-header">
        <div>
          
          {# Brand section - Logo typography #}
          <div>
            {{ renderHeading({ 
                name: headerData.brand.logo,
                datas: option.typographyDatas
            }) }}
          </div>
          
          {# Title section - Desktop only #}
          <div>
            {{ renderHeading({ 
                name: headerData.title.desktop,
                datas: option.typographyDatas
            }) }}
          </div>
          
          {# Navigation section - Desktop link #}
          <div>
            {{ renderLink({ 
                name: headerData.navigation.desktop_link,
                datas: option.linkDatas
            }) }}
          </div>
          
          {# Mobile burger button #}
          <button 
            id="burger-toggle"
            aria-label="Toggle mobile menu"
            aria-expanded="false"
          >
            <span>
              {{ renderIcon({ 
                  name: headerData.mobile.burger_open_icon,
                  datas: option.iconDatas
              }) }}
            </span>
            <span>
              {{ renderIcon({ 
                  name: headerData.mobile.burger_close_icon,
                  datas: option.iconDatas
              }) }}
            </span>
          </button>
          
        </div>
        
        {# Mobile overlay menu #}
        <div id="mobile-overlay">
          <div>
            {# Render the tab-menu mobile version inside overlay #}
            {{ renderTabMenu({ 
                name: headerData.navigation.mobile_menu,
                datas: option.tabMenuDatas,
                linkDatas: option.linkDatas
            }) }}
          </div>
        </div>
        
      </header>
    {% endif %}
  {% endif %}
{% endmacro %}

{#
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
May your bugs be forever exiled to the shadow realm ✦
Charlotte Carpentier · 2025
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
#}
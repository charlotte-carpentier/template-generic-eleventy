{# ┌─────────────────────────────────────────────────────────┐
   │ ORGANISM › Footer                                       │
   │ Site footer with branding, navigation, and copyright    │
   └─────────────────────────────────────────────────────────┘ #}

{#
  Props:
      - options.name (string): Footer identifier
      - options.datas (array): Footer configuration data
      - options.headingDatas (array): Heading atom data
      - options.linkDatas (array): Link atom data
      - options.vectorDatas (array): Vector atom data
      - options.navSecondaryDatas (array): Navigation secondary organism data
      - options.iconDatas (array): Icon atom data (optional, required if links have icons)

  Usage — Summon HAT Components Wisely:
    {% from "03-organisms/footer.njk" import renderFooter %}

    {{ renderFooter({
        name: "demoFooter1",
        datas: organisms.footer.footers,
        headingDatas: atoms.heading.headings,
        linkDatas: atoms.link.links,
        vectorDatas: atoms.vector.vectors,
        navSecondaryDatas: organisms["navigation-secondary"].navSecondary
    }) }}

  @created 2025-01-15
#}

{% macro renderFooter(options) %}
  {# Import sub-components #}
  {% from "01-atoms/heading.njk" import renderHeading %}
  {% from "01-atoms/link.njk" import renderLink %}
  {% from "01-atoms/vector.njk" import renderVector %}
  {% from "03-organisms/navigation-secondary.njk" import renderNavigationSecondary %}

  {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
    1. Validate Props
  ━━━━━━━━━━━━━━━━━━━━━━━━━ #}
  {% if not options.datas %}
    <span class="error" role="alert">Error: Missing required prop (datas)</span>
  {% elif not options.name %}
    <span class="error" role="alert">Error: Missing required prop (name)</span>
  {% else %}
    {# Find footer using universal filter #}
    {% set footerData = options.datas | findByName(options.name) %}

    {# Render footer or error message #}
    {% if not footerData %}
      <span class="error" role="alert">Footer not found: {{ options.name }}</span>
    {% else %}

      {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
        2. Compute Final Values
      ━━━━━━━━━━━━━━━━━━━━━━━━━ #}
      {% set footerName = footerData.name | default(options.name) %}
      {% set vectorName = footerData.vectorName | default('') %}
      {% set items = footerData.items | default([]) %}
      {% set copyright = footerData.copyright | default({}) %}
      {% set copyrightText = copyright.text | default('') %}
      {% set copyrightVersion = copyright.version | default('') %}
      {% set copyrightLinks = copyright.links | default([]) %}
      {% set ariaLabel = footerData.ariaLabel | default('Site footer') %}

      {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
        3. Tailwind Classes
        Index:
        3.1 Wrapper Classes
        3.2 Branding Section Classes
        3.3 Navigation Section Classes
        3.4 Column Classes
        3.5 Legal Section Classes
        3.6 Legal List Classes
        3.7 Copyright Wrapper Classes
        3.8 Copyright Text Classes
        3.9 Version Text Classes
        3.10 Separator Classes
      ━━━━━━━━━━━━━━━━━━━━━━━━━ #}

      {# --------------------------
          3.1 Wrapper Classes
          Description: Layout, Spacing, Background, Responsive
        --------------------------#}
      {% set footerClasses = "flex flex-col gap-[var(--spacing-stack-large)] p-[var(--spacing-inset-large)] bg-[var(--color-global-contrast-light-04)] md:p-[var(--spacing-inset-large)]" %}

      {# --------------------------
          3.2 Branding Section Classes
          Description: Layout
        --------------------------#}
      {% set brandingClasses = "flex" %}

      {# --------------------------
          3.3 Navigation Section Classes
          Description: Layout grid responsive, Gap
        --------------------------#}
      {% set navigationClasses = "grid grid-cols-1 gap-[var(--spacing-stack-large)] md:grid-cols-2 lg:grid-cols-4" %}

      {# --------------------------
          3.4 Column Classes
          Description: Layout, Spacing
        --------------------------#}
      {% set columnClasses = "flex flex-col gap-[var(--spacing-stack-medium)] [&_[data-column-heading]]:pl-[var(--spacing-inset-small)]" %}

      {# --------------------------
          3.5 Legal Section Classes
          Description: Layout responsive, Spacing, Borders
        --------------------------#}
      {% set legalClasses = "flex flex-col gap-[var(--spacing-stack-medium)] pt-[var(--spacing-stack-large)] md:flex-row md:items-center" %}

      {# --------------------------
          3.6 Legal List Classes
          Description: Layout responsive, Spacing, Responsive order
        --------------------------#}
      {% set legalNavClasses = "flex order-first md:order-last" %}
      {% set legalListClasses = "flex flex-col gap-[var(--spacing-stack-tight)] md:flex-row md:gap-[var(--spacing-inline-medium)]" %}

      {# --------------------------
          3.7 Copyright Wrapper Classes
          Description: Layout responsive, Spacing
        --------------------------#}
      {% set copyrightVersionWrapperClasses = "flex flex-wrap items-center gap-[var(--spacing-inline-medium)]" %}

      {# --------------------------
          3.8 Copyright Text Classes
          Description: Typography, Colors
        --------------------------#}
      {% set copyrightClasses = "typography-body-small text-[var(--color-global-contrast-light-01)]" %}

      {# --------------------------
          3.9 Version Text Classes
          Description: Typography, Colors, Responsive visibility
        --------------------------#}
      {% set versionClasses = "typography-body-small text-[var(--color-global-contrast-light-02)] hidden md:inline" %}

      {# --------------------------
          3.10 Separator Classes
          Description: Typography, Colors, Responsive visibility
        --------------------------#}
      {% set separatorClasses = "typography-body-small text-[var(--color-global-contrast-light-02)] hidden md:inline" %}

      {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
        4. Render HTML
      ━━━━━━━━━━━━━━━━━━━━━━━━━ #}
      <footer
        class="{{ footerClasses }}"
        role="contentinfo"
        aria-label="{{ ariaLabel }}"
        data-footer-name="{{ footerName }}"
        data-footer-type="footer"
      >

        {# Logo branding section #}
        <div
          class="{{ brandingClasses }}"
          data-footer-section="branding"
        >
          {{ renderVector({
              name: vectorName,
              datas: options.vectorDatas
          }) }}
        </div>

        {# Navigation columns section #}
        <div
          class="{{ navigationClasses }}"
          data-footer-section="navigation"
        >
          {% for item in items %}
            <div
              class="{{ columnClasses }}"
              data-footer-column
            >

              {# Column heading #}
              <div data-column-heading>
                {{ renderHeading({
                    name: item.headingName,
                    datas: options.headingDatas
                }) }}
              </div>

              {# Column navigation #}
              {{ renderNavigationSecondary({
                  name: item.navSecondaryName,
                  datas: options.navSecondaryDatas,
                  linkDatas: options.linkDatas,
                  iconDatas: options.iconDatas
              }) }}

            </div>
          {% endfor %}
        </div>

        {# Copyright and legal section #}
        <div
          class="{{ legalClasses }}"
          data-footer-section="legal"
        >

          {# Legal links navigation - First on mobile, last on desktop #}
          <nav
            class="{{ legalNavClasses }}"
            aria-label="Legal links"
          >
            <ul class="{{ legalListClasses }}">
              {% for linkName in copyrightLinks %}
                <li>
                  {{ renderLink({
                      name: linkName,
                      datas: options.linkDatas
                  }) }}
                </li>
              {% endfor %}
            </ul>
          </nav>

          {# Copyright and version wrapper #}
          <div
            class="{{ copyrightVersionWrapperClasses }}"
            data-footer-info
          >
            {# Copyright text #}
            <p
              class="{{ copyrightClasses }}"
              data-footer-copyright
            >
              {{ copyrightText }}
            </p>

            {# Separator (desktop only) #}
            <span
              class="{{ separatorClasses }}"
              aria-hidden="true"
            >
              •
            </span>

            {# Version info (desktop only) #}
            <p
              class="{{ versionClasses }}"
              data-footer-version
            >
              {{ copyrightVersion }}
            </p>

            {# Separator (desktop only) #}
            <span
              class="{{ separatorClasses }}"
              aria-hidden="true"
            >
              •
            </span>
          </div>

        </div>

      </footer>
    {% endif %}
  {% endif %}
{% endmacro %}

{#
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
May your bugs be forever exiled to the shadow realm ✦
HAT · 2025
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
#}

{# ┌─────────────────────────────────────────────────────────┐
   │ ORGANISM › Section Listing                              │
   │ Content listing section with cards and pagination       │
   └─────────────────────────────────────────────────────────┘ #}

{#
  Props:
    - options.name (string): Section identifier
    - options.datas (array): Section configuration data
    - options.headingDatas (array): Heading atom data
    - options.cardDatas (array): Card molecule data
    - options.paginationDatas (array): Pagination molecule data

  Usage — Summon HAT Components Wisely:
    {% from "03-organisms/section-listing.njk" import renderSectionListing %}

    {{ renderSectionListing({
        name: "demoSectL1",
        datas: organisms["section-listing"].sectListings,
        headingDatas: atoms.heading.headings,
        cardDatas: molecules.card.cards,
        paginationDatas: molecules.pagination.paginations
    }) }}

  @created 2025-01-15
#}

{% macro renderSectionListing(options) %}
  {# Import sub-components #}
  {% from "01-atoms/heading.njk" import renderHeading %}
  {% from "02-molecules/card.njk" import renderCard %}
  {% from "02-molecules/pagination.njk" import renderPagination %}

  {# Validate required props #}
  {% if not options.datas %}
    <span class="error" role="alert">Error: Missing required prop (datas)</span>
  {% elif not options.name %}
    <span class="error" role="alert">Error: Missing required prop (name)</span>
  {% else %}
    {# Find section using universal filter #}
    {% set sectionData = options.datas | findByName(options.name) %}

    {# Render section or error message #}
    {% if not sectionData %}
      <span class="error" role="alert">Section not found: {{ options.name }}</span>
    {% else %}
      {# Render section element - Listing pattern with semantic HTML #}
      <section 
        aria-label="{{ sectionData.ariaLabel }}"
        data-section-name="{{ sectionData.name }}"
        data-section-type="section-listing"
      >
        
        <div data-section-container>
          
          {# Section heading #}
          {% if sectionData.headingName %}
            <div data-section-heading>
              {{ renderHeading({
                  name: sectionData.headingName,
                  datas: options.headingDatas
              }) }}
            </div>
          {% endif %}
          
          {# Cards grid - Filter by tags if specified #}
          <div 
            data-section-cards
            data-items-per-page="{{ sectionData.itemsPerPage }}"
          >
            {% if sectionData.cardTags and options.cardDatas %}
              {# Filter cards by tags - Loop through all cards and check tags #}
              {% for card in options.cardDatas %}
                {# Check if card has matching tags #}
                {% if card.tags %}
                  {% for tag in sectionData.cardTags %}
                    {% if tag in card.tags %}
                      <div data-card-item>
                        {{ renderCard({
                            name: card.name,
                            datas: options.cardDatas
                        }) }}
                      </div>
                    {% endif %}
                  {% endfor %}
                {% endif %}
              {% endfor %}
            {% endif %}
          </div>
          
          {# Pagination - Optional #}
          {% if sectionData.paginationName %}
            <div data-section-pagination>
              {{ renderPagination({
                  name: sectionData.paginationName,
                  datas: options.paginationDatas
              }) }}
            </div>
          {% endif %}
          
        </div>
        
      </section>
    {% endif %}
  {% endif %}
{% endmacro %}

{#
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
May your bugs be forever exiled to the shadow realm ✦
Charlotte Carpentier · 2025
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
#}
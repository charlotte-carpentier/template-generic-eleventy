{# ┌─────────────────────────────────────────────────────────┐
   │ ATOM › Tag                                              │
   │ Labels and status tags with semantic attributes         │
   └─────────────────────────────────────────────────────────┘ #}

{#
  Usage — Summon HAT Components Wisely:
    {% from "01-atoms/tag.njk" import renderTag %}

    {{ renderTag({
        name: "demoTag1",
        datas: atoms.tag.tags
    }) }}

  @created 2025-09-15
#}

{% macro renderTag(options) %}

  {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
    1. Validate Props
  ━━━━━━━━━━━━━━━━━━━━━━━━━━ #}
  {% if not options.datas %}
    <span class="error" role="alert">Error: Missing required prop (datas)</span>
  {% elif not options.name %}
    <span class="error" role="alert">Error: Missing required prop (name)</span>
  {% else %}
    {# Find tag using universal filter #}
    {% set tagData = options.datas | findByName(options.name) %}

    {# Render tag or error message #}
    {% if not tagData %}
      <span class="error" role="alert">Tag not found: {{ options.name }}</span>
    {% else %}

      {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
        2. Compute Final Values
      ━━━━━━━━━━━━━━━━━━━━━━━━━━ #}
      {% set tagVariant = tagData.variant | default('default') %}

      {# TODO: isInteractive property reserved for future (dismissible/selectable tags) - See Carbon DS Tag patterns #}

      {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
        3. Tailwind Classes
        Index:
        3.1 Base Classes
        3.2 Variant Classes
      ━━━━━━━━━━━━━━━━━━━━━━━━━━ #}

      {# --------------------------
          3.1 Base Classes
          Description: Layout, spacing, borders, typography
      -------------------------- #}
      {% set baseClasses = "inline-flex items-center px-[var(--spacing-ui-minimal)] py-[var(--spacing-ui-minimal)] rounded-[var(--radius-default)] text-caption font-semibold uppercase tracking-wide" %}

      {# --------------------------
          3.2 Variant Classes
          Description: Colors, backgrounds, borders per semantic variant
      --------------------------- #}
      {% set variantMap = {
        'default': 'text-[var(--color-global-contrast-light-01)] bg-[var(--color-global-contrast-light-04)] border border-[var(--color-global-contrast-light-02)]',
        'default-filled': 'text-[var(--color-global-white)] bg-[var(--color-global-contrast-light-01)]',
        'primary': 'text-[var(--color-semantic-information)] bg-[var(--color-semantic-information-contrast-light-01)] border border-[var(--color-semantic-information)]',
        'primary-filled': 'text-[var(--color-global-white)] bg-[var(--color-semantic-information)]',
        'success': 'text-[var(--color-semantic-success)] bg-[var(--color-semantic-success-contrast-light-02)] border border-[var(--color-semantic-success)]',
        'success-filled': 'text-[var(--color-global-white)] bg-[var(--color-semantic-success)]',
        'warning': 'text-[var(--color-semantic-warning)] bg-[var(--color-semantic-warning-contrast-light-01)] border border-[var(--color-semantic-warning)]',
        'warning-filled': 'text-[var(--color-global-white)] bg-[var(--color-semantic-warning)]',
        'danger': 'text-[var(--color-semantic-critical)] bg-[var(--color-semantic-critical-contrast-light-01)] border border-[var(--color-semantic-critical)]',
        'danger-filled': 'text-[var(--color-global-white)] bg-[var(--color-semantic-critical)]'
      } %}
      {% set variantClasses = variantMap[tagVariant] or variantMap['default'] %}

      {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
        4. Render HTML
      ━━━━━━━━━━━━━━━━━━━━━━━━━━ #}
      <span
        data-tag-name="{{ tagData.name }}"
        data-tag-type="tag"
        data-tag-variant="{{ tagData.variant }}"
        {% if tagData.isInteractive %}data-tag-interactive="true"{% endif %}
        {% if tagData.role %}role="{{ tagData.role }}"{% endif %}
        {% if tagData.title %}title="{{ tagData.title }}"{% endif %}
        class="{{ baseClasses }} {{ variantClasses }}"
      >
        {{ tagData.text }}
        {% if tagData.screenReaderText %}
          <span class="sr-only">{{ tagData.screenReaderText }}</span>
        {% endif %}
      </span>
    {% endif %}
  {% endif %}
{% endmacro %}

{#
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
May your bugs be forever exiled to the shadow realm ✦
HAT · 2026
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
#}

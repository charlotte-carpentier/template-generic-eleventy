{# ┌─────────────────────────────────────────────────────────┐
   │ ATOM › Link                                             │
   │ Navigation links with variant styling                   │
   └─────────────────────────────────────────────────────────┘ #}

{#
  Props:
    - option.name (string): Link identifier
    - option.datas (array): Link configuration data
  
  Usage:
    {% from "01-atoms/link.njk" import renderLink %}
    
    {{ renderLink({ 
       name: "portfolio_link",
       datas: atoms.link.links
    }) }}
  
  Features:
    - Base + variant classes from input.css
    - Responsive font sizing based on variant
    - External link indicator (↗ symbol)
    - Download attribute support
    - Custom onclick handlers
  
  Accessibility:
    - Enhanced aria-label for mailto links
    - Indicates external links opening in new tab
    - Proper rel attributes for security
  
  @created 2025-01-15
#}

{% macro renderLink(option) %}
 {# Check if datas is provided #}
 {% if not option.datas %}
   <span>Error: No link configuration provided</span>
 {% else %}
   {# Retrieve link configuration #}
   {% set linksConfig = option.datas %}
   {% set linkName = option.name %}
   
   {# Find the specific link by name #}
   {% set linkData = null %}
   {% for link in linksConfig %}
     {% if link.name == linkName %}
       {% set linkData = link %}
     {% endif %}
   {% endfor %}

   {# Fallback if link not found #}
   {% if not linkData %}
     <span>Link not found: {{ linkName }}</span>
   {% else %}
     {# Build CSS classes #}
     {% set variant = linkData.variant | default('') %}
     {% set cssClasses = 'link link--' ~ variant %}
     
     {# Add responsive font size classes based on variant #}
     {% if variant == '' %}
       {% set cssClasses = cssClasses ~ '' %}
     {% elif variant == '' %}
       {% set cssClasses = cssClasses ~ '' %}
     {% elif variant == '' %}
       {% set cssClasses = cssClasses ~ '' %}
     {% elif variant == '' %}
       {% set cssClasses = cssClasses ~ '' %}
     {% endif %}
     
     {# Enhanced accessibility attributes #}
     {% set ariaLabel = '' %}
     {% if linkData.href and linkData.href.indexOf('mailto:') == 0 %}
       {% set ariaLabel = 'aria-label="Envoyer un email à ' ~ linkData.text ~ '"' %}
     {% elif linkData.target == '_blank' %}
       {% set ariaLabel = 'aria-label="' ~ linkData.text ~ ' - Ouvre dans un nouvel onglet"' %}
     {% endif %}
     
     {# Render the link #}
     <a 
       href="{{ linkData.href }}" 
       class="{{ cssClasses }}"
       {% if linkData.target %}target="{{ linkData.target }}"{% endif %}
       {% if linkData.download %}download{% endif %}
       {% if linkData.rel %}rel="{{ linkData.rel }}"{% endif %}
       {% if linkData.onclick %}onclick="{{ linkData.onclick }}"{% endif %}
       {% if ariaLabel %}{{ ariaLabel | safe }}{% endif %}
     >
       {{ linkData.text | safe }}
       {% if linkData.variant == '' %}
         <span aria-hidden="true">↗</span>
       {% endif %}
     </a>
   {% endif %}
 {% endif %}
{% endmacro %}

{#
============================
Summon HAT Components Wisely
============================

May your bugs be forever exiled to the shadow realm. ✦
#}
{# ┌─────────────────────────────────────────────────────────┐
   │ ATOM › Radio Button                                     │
   │ Radio inputs with label and description support         │
   └─────────────────────────────────────────────────────────┘ #}

{#
  Props:
    - options.id (string): Radio button identifier for single rendering
    - options.group (boolean): Render as group if true
    - options.groupLabel (string): Group label text for fieldset legend
    - options.groupSrOnly (boolean): Hide group label visually
    - options.datas (object): Radio button configuration data

  Usage — Summon HAT Components Wisely:
    {% from "01-atoms/radio-button.njk" import renderRadioButton %}

    Single radio button:
    {{ renderRadioButton({
        id: "demoRadio1",
        datas: atoms["radio-button"].radioButtons
    }) }}

    Group of radio buttons:
    {{ renderRadioButton({
        group: true,
        groupLabel: "Choose an option",
        datas: atoms["radio-button"].radioButtons
    }) }}

  @created 2025-01-15
#}

{% macro renderRadioButton(options) %}
  {# Validate required props #}
  {% if not options.datas %}
    <span class="error" role="alert">Error: Missing required prop (datas)</span>
  {% elif options.group %}
    {# Group mode validation #}
    {% if not options.groupLabel %}
      <span class="error" role="alert">Error: Missing required prop (groupLabel) for group mode</span>
    {% else %}
      {# Render fieldset group #}
      <fieldset data-radio-group-type="radio-button">
        <legend {% if options.groupSrOnly %}class="sr-only"{% endif %}>
          {{ options.groupLabel }}
        </legend>

        {% for radioButton in options.datas.radioButtons %}
          {{ renderSingleRadio(radioButton) }}
        {% endfor %}
      </fieldset>
    {% endif %}
  {% elif not options.id %}
    <span class="error" role="alert">Error: Missing required prop (id) for single mode</span>
  {% else %}
    {# Single mode - find radio button using universal filter #}
    {% set radioButtonData = options.datas | findByName(options.id) %}

    {% if not radioButtonData %}
      <span class="error" role="alert">Radio button not found: {{ options.id }}</span>
    {% else %}
      {{ renderSingleRadio(radioButtonData) }}
    {% endif %}
  {% endif %}
{% endmacro %}

{% macro renderSingleRadio(radioButton) %}
  {# Read nested structure with fallbacks #}
  {% set radioData = radioButton.radio | default({}) %}
  {% set radioValue = radioData.value | default(radioButton.id) %}
  {% set isChecked = radioData.checked | default(false) %}
  {% set isDisabled = radioData.disabled | default(false) %}

  {# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
     CSS Classes - Tailwind Utilities
  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ #}

  {# Label wrapper classes
     Flexbox layout for radio + text alignment #}
  {% set labelClasses = "inline-flex items-center gap-2 cursor-pointer group" %}

  {# Radio input classes
     1px border, relative for ::after pseudo-element (WCAG 2.2 AA) #}
  {% set radioClasses = "relative appearance-none w-5 h-5 border border-[var(--color-form)] rounded-full bg-white cursor-pointer transition-all focus:outline-none focus:ring-2 focus:ring-[var(--color-semantic-information-focus)] hover:border-[var(--color-form-hover)] checked:border-[var(--color-form-control-checked)] disabled:opacity-50 disabled:cursor-not-allowed" %}

  {# Checked state indicator - Colored dot (same color as border)
     12px dot centered inside 20px circle #}
  {% set checkedIndicatorClasses = "checked:after:content-[''] checked:after:absolute checked:after:top-1/2 checked:after:left-1/2 checked:after:-translate-x-1/2 checked:after:-translate-y-1/2 checked:after:w-3 checked:after:h-3 checked:after:rounded-full checked:after:bg-[var(--color-form-control-checked)]" %}

  {# Label text classes
     Typography and color matching border state (default + hover) #}
  {% set textClasses = "text-base text-[var(--color-form)] group-hover:text-[var(--color-form-hover)] select-none transition-colors" %}

  {# Render radio button with label #}
  <label for="{{ radioButton.id }}" class="{{ labelClasses }}">
    <input
      type="radio"
      id="{{ radioButton.id }}"
      name="{{ radioButton.name | default('radio-group') }}"
      value="{{ radioValue }}"
      class="{{ radioClasses }} {{ checkedIndicatorClasses }}"
      data-radio-id="{{ radioButton.id }}"
      data-radio-type="radio-button"
      {% if isChecked %}checked{% endif %}
      {% if isDisabled %}disabled{% endif %}
      {% if radioButton.ariaLabel %}aria-label="{{ radioButton.ariaLabel }}"{% endif %}
    />

    {% if radioButton.label %}
      <span class="{{ textClasses }}">{{ radioButton.label }}</span>
    {% endif %}
  </label>
{% endmacro %}

{#
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
May your bugs be forever exiled to the shadow realm ✦
Charlotte Carpentier · 2025
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
#}
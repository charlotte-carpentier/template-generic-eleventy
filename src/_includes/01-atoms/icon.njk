{# ┌─────────────────────────────────────────────────────────┐
   │ ATOM › Icon                                             │
   │ SVG icons with size variants and styling                │
   └─────────────────────────────────────────────────────────┘ #}

{#
  Props:
    - option.name (string): Icon identifier
    - option.datas (array): Icon configuration data
    - option.class (string): Additional CSS classes
  
  Usage:
    {% from "01-atoms/icon.njk" import renderIcon %}
    
    {{ renderIcon({ 
        name: "skills_treasure",
        datas: atoms.icon.icons
    }) }}
  
  Notes:
    - Uses SVG sprite for fast loading
    - Base + variant classes from input.css
    - Supports responsive sizing based on variant
    - Sprite ID can be customized or defaults to icon name
  
  Accessibility:
    - Uses role="img" for proper screen reader support
    - Includes aria-label for descriptive text
  
  @created 2025-01-15
#}

{% macro renderIcon(option) %}
  {# Check if option and required data is provided #}
  {% if not option or not option.datas or not option.name %}
    <span>Error: No icon configuration provided</span>
  {% else %}
    {# Retrieve icon configuration #}
    {% set iconsConfig = option.datas %}
    {% set iconName = option.name %}
    
    {# Find the specific icon by name #}
    {% set iconData = null %}
    {% for icon in iconsConfig %}
      {% if icon.name == iconName %}
        {% set iconData = icon %}
      {% endif %}
    {% endfor %}

    {# Fallback if icon not found #}
    {% if not iconData %}
      <span>Icon not found: {{ iconName }}</span>
    {% else %}
      {# Build CSS classes #}
      {% set variant = iconData.variant | default('') %}
      {% set cssClasses = 'icon-' ~ variant %}
      
      {# Add responsive classes based on variant #}
      {% if variant == '' %}
        {% set cssClasses = cssClasses %}
      {% elif variant == '' %}
        {% set cssClasses = cssClasses %}
      {% elif variant == '' %}
        {% set cssClasses = cssClasses %}
      {% endif %}
      
      {# Add any additional classes #}
      {% if option.class %}
        {% set cssClasses = cssClasses ~ ' ' ~ option.class %}
      {% endif %}
      
      {# Generate sprite ID from name with fallback #}
      {% set spriteId = iconData.spriteId | default(iconName) %}
      
      {# SVG Sprite usage - clean and fast #}
      <svg 
        class="{{ cssClasses }}" 
        aria-label="{{ iconData.alt | default('Icon') }}"
        role="img"
      >
        <use href="/assets/icons/sprites/sprite.svg#{{ spriteId }}"></use>
      </svg>
    {% endif %}
  {% endif %}
{% endmacro %}

{#
============================
Summon HAT Components Wisely
============================

May your bugs be forever exiled to the shadow realm. ✦
#}
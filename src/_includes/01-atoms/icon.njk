{# ┌─────────────────────────────────────────────────────────┐
   │ ATOM › Icon                                             │
   │ SVG icons with size variants and styling                │
   └─────────────────────────────────────────────────────────┘ #}

{#
  Props:
    - options.name (string): Icon identifier
    - options.datas (object): Icon configuration data (nested by category)
    - options.class (string): Additional CSS classes

  Usage — Summon HAT Components Wisely:
    {% from "01-atoms/icon.njk" import renderIcon %}

    {{ renderIcon({
        name: "demoSmile1",
        datas: atoms.icon.icons
    }) }}

  @created 2025-01-15
#}

{% macro renderIcon(options) %}
  {# Validate required props #}
  {% if not options.datas %}
    <span class="error" role="alert">Error: Missing required prop (datas)</span>
  {% elif not options.name %}
    <span class="error" role="alert">Error: Missing required prop (name)</span>
  {% else %}
    {# Find icon using universal filter - handles nested categories automatically #}
    {% set iconData = options.datas | findByName(options.name) %}

    {# Render icon or error message #}
    {% if not iconData %}
      <span class="error" role="alert">Icon not found: {{ options.name }}</span>
    {% else %}
      {# Compute final values with fallback cascade #}
      {% set spriteId = iconData.spriteId | default(options.name) %}
      {% set iconAlt = iconData.alt | default('Icon') %}

      {# Build CSS classes #}
      {% set cssClasses = 'icon' %}
      {% if iconData.variant %}
        {% set cssClasses = cssClasses ~ ' icon-' ~ iconData.variant %}
      {% endif %}
      {% if options.class %}
        {% set cssClasses = cssClasses ~ ' ' ~ options.class %}
      {% endif %}

      {# Render SVG sprite #}
      <svg
        class="{{ cssClasses }}"
        aria-label="{{ iconAlt }}"
        role="img"
        data-icon-name="{{ iconData.name }}"
        data-icon-type="icon"
      >
        <use href="/assets/icons/sprites/sprite.svg#{{ spriteId }}"></use>
      </svg>
    {% endif %}
  {% endif %}
{% endmacro %}

{#
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
May your bugs be forever exiled to the shadow realm ✦
Charlotte Carpentier · 2025
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
#}

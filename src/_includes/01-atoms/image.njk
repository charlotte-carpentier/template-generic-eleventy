{# ┌─────────────────────────────────────────────────────────┐
   │ ATOM › Image                                            │
   │ Responsive images with variant styling                  │
   └─────────────────────────────────────────────────────────┘ #}

{#
  Props:
    - options.name (string): Image identifier
    - options.datas (array): Image configuration data

  Usage — Summon HAT Components Wisely:
    {% from "01-atoms/image.njk" import renderImage %}

    {{ renderImage({
        name: "demoImage1",
        datas: atoms.image.images
    }) }}

  @created 2025-01-15
#}

{% macro renderImage(options) %}
  {# Validate required props #}
  {% if not options.datas %}
    <span class="error" role="alert">Error: Missing required prop (datas)</span>
  {% elif not options.name %}
    <span class="error" role="alert">Error: Missing required prop (name)</span>
  {% else %}
    {# Find image using universal filter #}
    {% set imageData = options.datas | findByName(options.name) %}

    {# Render image or error message #}
    {% if not imageData %}
      <span class="error" role="alert">Image not found: {{ options.name }}</span>
    {% else %}
      {# Compute final values with fallback cascade #}
      {% set imageSrc = imageData.src | default('') %}
      {% set imageAlt = imageData.alt | default('') %}

      {# Build CSS classes #}
      {% set cssClasses = 'image' %}
      {% if imageData.variant %}
        {% set cssClasses = cssClasses ~ ' image-' ~ imageData.variant %}
      {% endif %}

      {# Render image element #}
      <img
        src="{{ imageSrc }}"
        alt="{{ imageAlt }}"
        class="{{ cssClasses }}"
        loading="lazy"
        decoding="async"
        data-image-name="{{ imageData.name }}"
        data-image-type="image"
        {% if imageData.width %}width="{{ imageData.width }}"{% endif %}
        {% if imageData.height %}height="{{ imageData.height }}"{% endif %}
      />
    {% endif %}
  {% endif %}
{% endmacro %}

{#
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
May your bugs be forever exiled to the shadow realm ✦
Charlotte Carpentier · 2025
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
#}

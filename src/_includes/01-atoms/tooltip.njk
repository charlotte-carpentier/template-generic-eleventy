{# ┌─────────────────────────────────────────────────────────┐
   │ ATOM › Tooltip                                          │
   │ Contextual help content bubble                          │
   └─────────────────────────────────────────────────────────┘ #}

{#
  Props:
    - options.name (string): Tooltip identifier
    - options.datas (array): Tooltip configuration

  Usage — Summon HAT Components Wisely:
    {% from "01-atoms/tooltip.njk" import renderTooltip %}

    1. Add aria-describedby on trigger element
    <button aria-describedby="tooltip-demoTooltip1">
      Help
    </button>

    2. Render tooltip atom
    {{ renderTooltip({
        name: "demoTooltip1",
        datas: atoms.tooltip.tooltips
    }) }}

  Note:
    - Triggers MUST have aria-describedby="tooltip-{name}"
    - JavaScript service (utils/tooltip.js) auto-detects all [aria-describedby^="tooltip-"]
    - JS MUST implement: show on focus/mouseenter, hide on blur/mouseleave/Esc, aria-hidden toggle
    - No manual init needed in components

  @created 2025-01-15
#}

{% macro renderTooltip(options) %}

  {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
    1. Validate Props
  ━━━━━━━━━━━━━━━━━━━━━━━━━━ #}
  {% if not options.datas %}
    <span class="error" role="alert">Error: Missing required prop (datas)</span>
  {% elif not options.name %}
    <span class="error" role="alert">Error: Missing required prop (name)</span>
  {% else %}
    {% set tooltipData = options.datas | findByName(options.name) %}

    {% if not tooltipData %}
      <span class="error" role="alert">Tooltip not found: {{ options.name }}</span>
    {% else %}

      {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
        2. Compute Final Values
      ━━━━━━━━━━━━━━━━━━━━━━━━━━ #}
      {% set tooltipId = 'tooltip-' ~ tooltipData.name %}

      {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
        3. Tailwind Classes
        Index:
        3.1 Tooltip Container Classes
        3.2 Title Classes
        3.3 Description Classes
        3.4 Multi-part Wrapper Classes
      ━━━━━━━━━━━━━━━━━━━━━━━━━━ #}

      {# --------------------------
          3.1 Tooltip Container Classes
          Description: Positioning, spacing, typography, colors, effects, borders
      -------------------------- #}
      {% set tooltipClasses = "hidden absolute p-[var(--spacing-inset-small)] bg-[var(--color-global-white)] text-[var(--color-global-default)] shadow-[var(--elevation-floating)] rounded-[var(--radius-default)] min-w-[280px] max-w-xs z-[var(--z-tooltip)]" %}

      {# --------------------------
          3.2 Title Classes
          Description: Typography, colors
      -------------------------- #}
      {% set titleClasses = "text-[var(--color-global-contrast-light-01)] text-base font-medium" %}

      {# --------------------------
          3.3 Description Classes
          Description: Typography, colors, spacing
      -------------------------- #}
      {% set descriptionClasses = "text-sm text-[var(--color-global-contrast-light-01)] mt-[var(--spacing-stack-small)]" %}

      {# --------------------------
          3.4 Multi-part Wrapper Classes
          Description: Spacing
      -------------------------- #}
      {% set multiPartWrapperClasses = "mt-[var(--spacing-stack-small)] space-y-[var(--spacing-stack-small)]" %}

      {# ━━━━━━━━━━━━━━━━━━━━━━━━━━
        4. Render HTML
      ━━━━━━━━━━━━━━━━━━━━━━━━━━ #}
      <div
        id="{{ tooltipId }}"
        role="tooltip"
        aria-hidden="true"
        class="{{ tooltipClasses }}"
      >
        {% if tooltipData.title %}
          <div class="{{ titleClasses }}">{{ tooltipData.title }}</div>
        {% endif %}

        {% if tooltipData.description %}
          <div class="{{ descriptionClasses }}">{{ tooltipData.description }}</div>
        {% endif %}

        {% if tooltipData.descriptionPart1 or tooltipData.descriptionPart2 %}
          <div class="{{ multiPartWrapperClasses }}">
            {% if tooltipData.descriptionPart1 %}
              <div class="{{ descriptionClasses }}">{{ tooltipData.descriptionPart1 }}</div>
            {% endif %}

            {% if tooltipData.descriptionPart2 %}
              <div class="{{ descriptionClasses }}">{{ tooltipData.descriptionPart2 }}</div>
            {% endif %}
          </div>
        {% endif %}
      </div>
    {% endif %}
  {% endif %}
{% endmacro %}

{#
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
May your bugs be forever exiled to the shadow realm ✦
HAT · 2025
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
#}
